<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£ - å±å±çš„åšå®¢</title>
  <meta name="description" content="Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£

Springæ¡†æ¶ä½œä¸ºJavaå¼€å‘ä¸­æœ€æµè¡Œçš„æ¡†æ¶ä¹‹ä¸€ï¼Œå…¶ä¼˜é›…çš„æ¶æ„è®¾è®¡ç¦»ä¸å¼€å¯¹è®¾è®¡æ¨¡å¼çš„å·§å¦™è¿ç”¨ã€‚æœ¬æ–‡å°†ç»“åˆSpringæºç ï¼Œé‡ç‚¹è®²è§£ä»£ç†æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼å’Œå·¥å‚æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨ã€‚

 ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ

è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€...">
  <meta name="theme-color" content="#6366f1">
  <meta property="og:title" content="Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£">
  <meta property="og:description" content="Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£

Springæ¡†æ¶ä½œä¸ºJavaå¼€å‘ä¸­æœ€æµè¡Œçš„æ¡†æ¶ä¹‹ä¸€ï¼Œå…¶ä¼˜é›…çš„æ¶æ„è®¾è®¡ç¦»ä¸å¼€å¯¹è®¾è®¡æ¨¡å¼çš„å·§å¦™è¿ç”¨ã€‚æœ¬æ–‡å°†ç»“åˆSpringæºç ï¼Œé‡ç‚¹è®²è§£ä»£ç†æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼å’Œå·¥å‚æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨ã€‚

 ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ

è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€...">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://zhizhi2213.github.io/static/posts/Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£/">
  <meta property="og:site_name" content="å±å±çš„åšå®¢">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:author" content="zhizhi2213">
  <meta property="article:published_time" content="2026å¹´2æœˆ9æ—¥">
  
  <meta property="article:tag" content="{{.}}">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£">
  <meta name="twitter:description" content="Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£

Springæ¡†æ¶ä½œä¸ºJavaå¼€å‘ä¸­æœ€æµè¡Œçš„æ¡†æ¶ä¹‹ä¸€ï¼Œå…¶ä¼˜é›…çš„æ¶æ„è®¾è®¡ç¦»ä¸å¼€å¯¹è®¾è®¡æ¨¡å¼çš„å·§å¦™è¿ç”¨ã€‚æœ¬æ–‡å°†ç»“åˆSpringæºç ï¼Œé‡ç‚¹è®²è§£ä»£ç†æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼å’Œå·¥å‚æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨ã€‚

 ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ

è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€...">
  <link rel="stylesheet" href="/static/assets/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
  <div class="background-animation"></div>
  <div class="background-animation background-animation-2"></div>
  
  <div class="reading-progress-bar" id="readingProgressBar"></div>
  
  <a href="#main-content" class="skip-link">è·³è½¬åˆ°ä¸»è¦å†…å®¹</a>
  
  <header class="header">
    <div class="container">
      <nav class="nav">
        <a href="/" class="logo">å±å±çš„åšå®¢</a>
        <div class="nav-links">
          <a href="/" class="nav-link">é¦–é¡µ</a>
          <a href="/static/archives/" class="nav-link">å½’æ¡£</a>
          <a href="/static/tags/" class="nav-link">æ ‡ç­¾</a>
        </div>
        <div class="header-actions">
          <button class="search-toggle" aria-label="æœç´¢">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          </button>
          <button class="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">
            <span class="theme-icon">ğŸŒ™</span>
          </button>
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="æ‰“å¼€èœå•">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
          </button>
        </div>
      </nav>
      
      <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-backdrop" id="mobileMenuBackdrop"></div>
        <div class="mobile-menu-content">
          <div class="mobile-menu-header">
            <a href="/" class="logo">å±å±çš„åšå®¢</a>
            <button class="mobile-menu-close" id="mobileMenuClose" aria-label="å…³é—­èœå•">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
          </div>
          <div class="mobile-menu-links">
            <a href="/" class="mobile-menu-link">é¦–é¡µ</a>
            <a href="/static/archives/" class="mobile-menu-link">å½’æ¡£</a>
            <a href="/static/tags/" class="mobile-menu-link">æ ‡ç­¾</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="search-modal" id="searchModal">
    <div class="search-modal-backdrop" id="searchBackdrop"></div>
    <div class="search-modal-content">
      <div class="search-header">
        <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢æ–‡ç« ..." autocomplete="off">
        <button class="search-close" id="searchClose" aria-label="å…³é—­æœç´¢">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>
      <div class="search-results" id="searchResults"></div>
    </div>
  </div>

  <main class="main" id="main-content">
    <div class="post-layout-container">
      <div class="post-layout">
        <aside class="posts-sidebar">
          <h3 class="posts-sidebar-title">æ–‡ç« ç›®å½•</h3>
          <nav class="posts-sidebar-content" id="postsSidebarContent">
            <ul class="posts-sidebar-list">
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/MyBatisæºç æ·±åº¦è§£æ/" class="posts-sidebar-link">MyBatisæºç æ·±åº¦è§£æ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ/" class="posts-sidebar-link">ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/Spring-IOCä¸AOPè¯¦è§£/" class="posts-sidebar-link">Spring IOCä¸AOPè¯¦è§£</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£/" class="posts-sidebar-link active">Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/HashMapæºç åˆ†æ/" class="posts-sidebar-link">HashMapæºç åˆ†æ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/javaè¯­æ³•ç³–è¯¦è§£/" class="posts-sidebar-link">javaè¯­æ³•ç³–è¯¦è§£</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/Trae-Javaç¯å¢ƒé…ç½®/" class="posts-sidebar-link">Trae-Javaç¯å¢ƒé…ç½®</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢/" class="posts-sidebar-link">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/ä¸ºä»€ä¹ˆJavaä¸­åªæœ‰å€¼ä¼ é€’/" class="posts-sidebar-link">ä¸ºä»€ä¹ˆJavaä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/å…³äºæŠ€æœ¯åˆ†äº«/" class="posts-sidebar-link">å…³äºæŠ€æœ¯åˆ†äº«</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/ä»£ç ä¹‹ç¾/" class="posts-sidebar-link">ä»£ç ä¹‹ç¾</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/é¦–é¡µç¾åŒ–æ•™ç¨‹/" class="posts-sidebar-link">é¦–é¡µç¾åŒ–æ•™ç¨‹</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/å¦‚ä½•åˆ›å»ºGitHubä¸ªäººç½‘ç«™/" class="posts-sidebar-link">å¦‚ä½•åˆ›å»ºGitHubä¸ªäººç½‘ç«™</a>
              </li>
              
            </ul>
          </nav>
        </aside>

        <article class="post">
          <div class="post-header">
            <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1 class="post-title">Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£</h1>
            <div class="post-meta">
              <span class="post-date">2026å¹´2æœˆ9æ—¥</span>
              <span class="post-views" id="postViews">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                <span>åŠ è½½ä¸­...</span>
              </span>
              <span class="post-tag">è®¾è®¡æ¨¡å¼</span><span class="post-tag">Spring</span><span class="post-tag">Java</span>
            </div>
          </div>

          <div class="post-content">
            <h1>Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£</h1>
<p>Springæ¡†æ¶ä½œä¸ºJavaå¼€å‘ä¸­æœ€æµè¡Œçš„æ¡†æ¶ä¹‹ä¸€ï¼Œå…¶ä¼˜é›…çš„æ¶æ„è®¾è®¡ç¦»ä¸å¼€å¯¹è®¾è®¡æ¨¡å¼çš„å·§å¦™è¿ç”¨ã€‚æœ¬æ–‡å°†ç»“åˆSpringæºç ï¼Œé‡ç‚¹è®²è§£ä»£ç†æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼å’Œå·¥å‚æ¨¡å¼åœ¨Springä¸­çš„åº”ç”¨ã€‚</p>
<h2 id="ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼">ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ</h2>
<p>è®¾è®¡æ¨¡å¼æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»ç¼–ç›®çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€‚</p>
<h2 id="1-ä»£ç†æ¨¡å¼-Proxy-Pattern">1. ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼">ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼ï¼Ÿ</h3>
<p>ä»£ç†æ¨¡å¼ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå¯¹è±¡ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç›´æ¥å¼•ç”¨å¦ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’Œç›®æ ‡å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ã€‚</p>
<h3 id="Springä¸­çš„åº”ç”¨">Springä¸­çš„åº”ç”¨</h3>
<p>Springä¸­æœ€ç»å…¸çš„ä»£ç†æ¨¡å¼åº”ç”¨å°±æ˜¯**AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰**çš„å®ç°ã€‚</p>
<h4 id="åŠ¨æ€ä»£ç†ç¤ºä¾‹" tabindex="-1">åŠ¨æ€ä»£ç†ç¤ºä¾‹</h4>
<p>Spring AOPä¸»è¦é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°åŠ¨æ€ä»£ç†ï¼š</p>
<ol>
<li><strong>JDKåŠ¨æ€ä»£ç†</strong>ï¼ˆåŸºäºæ¥å£ï¼‰</li>
<li><strong>CGLIBä»£ç†</strong>ï¼ˆåŸºäºç±»ï¼‰</li>
</ol>
<p>Springæºç ä¸­çš„å…³é”®ç±»ï¼š</p>
<ul>
<li><code>org.springframework.aop.framework.JdkDynamicAopProxy</code></li>
<li><code>org.springframework.aop.framework.CglibAopProxy</code></li>
</ul>
<pre class="language-java"><code class="language-java"><span class="token comment">// Springæºç ä¸­çš„JdkåŠ¨æ€ä»£ç†å®ç°ç‰‡æ®µ</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdkDynamicAopProxy</span> <span class="token keyword">implements</span> <span class="token class-name">AopProxy</span><span class="token punctuation">,</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AdvisedSupport</span> advised<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">JdkDynamicAopProxy</span><span class="token punctuation">(</span><span class="token class-name">AdvisedSupport</span> config<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>advised <span class="token operator">=</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token class-name">ClassUtils</span><span class="token punctuation">.</span><span class="token function">getDefaultClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxy</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span> classLoader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">,</span> 
            <span class="token keyword">this</span><span class="token punctuation">.</span>advised<span class="token punctuation">.</span><span class="token function">getTargetClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
            <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token class-name">MethodInvocation</span> invocation <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> oldProxy <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> setProxyContext <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

        <span class="token class-name">TargetSource</span> targetSource <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>advised<span class="token punctuation">.</span>targetSource<span class="token punctuation">;</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> targetClass <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Object</span> target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‰§è¡Œç›®æ ‡æ–¹æ³•</span>
            <span class="token keyword">return</span> retVal<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ¸…ç†å·¥ä½œ</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="å®é™…åº”ç”¨åœºæ™¯" tabindex="-1">å®é™…åº”ç”¨åœºæ™¯</h4>
<pre class="language-java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¿å­˜ç”¨æˆ·: "</span> <span class="token operator">+</span> user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteUser</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åˆ é™¤ç”¨æˆ·: "</span> <span class="token operator">+</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨Spring AOPæ·»åŠ æ—¥å¿—åˆ‡é¢</span>
<span class="token annotation punctuation">@Aspect</span>
<span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoggingAspect</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Before</span><span class="token punctuation">(</span><span class="token string">"execution(* com.example.service.*.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logBefore</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œæ–¹æ³•: "</span> <span class="token operator">+</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@After</span><span class="token punctuation">(</span><span class="token string">"execution(* com.example.service.*.*(..))"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">logAfter</span><span class="token punctuation">(</span><span class="token class-name">JoinPoint</span> joinPoint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ–¹æ³•æ‰§è¡Œå®Œæ¯•: "</span> <span class="token operator">+</span> joinPoint<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="ä»£ç†æ¨¡å¼çš„ä¼˜åŠ¿">ä»£ç†æ¨¡å¼çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>èŒè´£æ¸…æ™°</strong>ï¼šçœŸå®è§’è‰²åªéœ€å…³æ³¨ä¸šåŠ¡é€»è¾‘</li>
<li><strong>é«˜æ‰©å±•æ€§</strong>ï¼šä»£ç†å¯¹è±¡å¯ä»¥åœ¨ä¸ä¿®æ”¹çœŸå®å¯¹è±¡çš„æƒ…å†µä¸‹å¢åŠ é¢å¤–åŠŸèƒ½</li>
<li><strong>æ™ºèƒ½åŒ–</strong>ï¼šåŠ¨æ€ä»£ç†å¯ä»¥åœ¨è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªå¯¹è±¡</li>
</ol>
<h2 id="2-é€‚é…å™¨æ¨¡å¼-Adapter-Pattern">2. é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼">ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼ï¼Ÿ</h3>
<p>é€‚é…å™¨æ¨¡å¼å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚</p>
<h3 id="Springä¸­çš„åº”ç”¨">Springä¸­çš„åº”ç”¨</h3>
<p>Springä¸­é€‚é…å™¨æ¨¡å¼çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<h4 id="2.1-spring-mvcä¸­çš„é€‚é…å™¨" tabindex="-1">2.1 Spring MVCä¸­çš„é€‚é…å™¨</h4>
<p>åœ¨Spring MVCä¸­ï¼Œä¸åŒçš„Controllerç±»å‹ï¼ˆå¦‚æ³¨è§£@Controllerã€å®ç°Controlleræ¥å£ã€HttpRequestHandlerç­‰ï¼‰é€šè¿‡é€‚é…å™¨æ¨¡å¼ç»Ÿä¸€å¤„ç†ã€‚</p>
<p>å…³é”®ç±»ï¼š</p>
<ul>
<li><code>org.springframework.web.servlet.HandlerAdapter</code></li>
<li><code>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter</code></li>
<li><code>org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter</code></li>
</ul>
<pre class="language-java"><code class="language-java"><span class="token comment">// HandlerAdapteræ¥å£å®šä¹‰</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">HandlerAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Object</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ModelAndView</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> 
                        <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> 
                        <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>

    <span class="token keyword">long</span> <span class="token function">getLastModified</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// RequestMappingHandlerAdapterå®ç°</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestMappingHandlerAdapter</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractHandlerMethodAdapter</span>
        <span class="token keyword">implements</span> <span class="token class-name">BeanFactoryAware</span><span class="token punctuation">,</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">supportsInternal</span><span class="token punctuation">(</span><span class="token class-name">HandlerMethod</span> handlerMethod<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">ModelAndView</span> <span class="token function">handleInternal</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span>
                                          <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span>
                                          <span class="token class-name">HandlerMethod</span> handlerMethod<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¤„ç†æ³¨è§£ç±»å‹çš„Controller</span>
        <span class="token keyword">return</span> <span class="token function">invokeHandlerMethod</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> handlerMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// HttpRequestHandlerAdapterå®ç°</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpRequestHandlerAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerAdapter</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supports</span><span class="token punctuation">(</span><span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>handler <span class="token keyword">instanceof</span> <span class="token class-name">HttpRequestHandler</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">ModelAndView</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span>
                               <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span>
                               <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpRequestHandler</span><span class="token punctuation">)</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">handleRequest</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="2.2-spring-aopä¸­çš„é€‚é…å™¨" tabindex="-1">2.2 Spring AOPä¸­çš„é€‚é…å™¨</h4>
<p>Spring AOPé€šè¿‡é€‚é…å™¨æ¨¡å¼å°†ä¸åŒçš„Adviceï¼ˆé€šçŸ¥ï¼‰ç±»å‹é€‚é…åˆ°ç»Ÿä¸€çš„æ‹¦æˆªå™¨é“¾ä¸­ã€‚</p>
<p>å…³é”®ç±»ï¼š</p>
<ul>
<li><code>org.springframework.aop.framework.adapter.AdvisorAdapter</code></li>
<li><code>org.springframework.aop.framework.adapter.MethodBeforeAdviceAdapter</code></li>
<li><code>org.springframework.aop.framework.adapter.AfterReturningAdviceAdapter</code></li>
</ul>
<pre class="language-java"><code class="language-java"><span class="token comment">// AdvisorAdapteræ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">AdvisorAdapter</span> <span class="token punctuation">{</span>

    <span class="token keyword">boolean</span> <span class="token function">supportsAdvice</span><span class="token punctuation">(</span><span class="token class-name">Advice</span> advice<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">MethodInterceptor</span> <span class="token function">getInterceptor</span><span class="token punctuation">(</span><span class="token class-name">Advisor</span> advisor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// MethodBeforeAdviceAdapterå®ç°</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MethodBeforeAdviceAdapter</span> <span class="token keyword">implements</span> <span class="token class-name">AdvisorAdapter</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">supportsAdvice</span><span class="token punctuation">(</span><span class="token class-name">Advice</span> advice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>advice <span class="token keyword">instanceof</span> <span class="token class-name">MethodBeforeAdvice</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">MethodInterceptor</span> <span class="token function">getInterceptor</span><span class="token punctuation">(</span><span class="token class-name">Advisor</span> advisor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">MethodBeforeAdvice</span> advice <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">MethodBeforeAdvice</span><span class="token punctuation">)</span> advisor<span class="token punctuation">.</span><span class="token function">getAdvice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MethodBeforeAdviceInterceptor</span><span class="token punctuation">(</span>advice<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// é€‚é…å™¨å®ç°</span>
<span class="token keyword">class</span> <span class="token class-name">MethodBeforeAdviceInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">MethodInterceptor</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">MethodBeforeAdvice</span> advice<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">MethodBeforeAdviceInterceptor</span><span class="token punctuation">(</span><span class="token class-name">MethodBeforeAdvice</span> advice<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>advice <span class="token operator">=</span> advice<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">MethodInvocation</span> mi<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰æ‰§è¡Œ</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>advice<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span>mi<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mi<span class="token punctuation">.</span><span class="token function">getArguments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mi<span class="token punctuation">.</span><span class="token function">getThis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> mi<span class="token punctuation">.</span><span class="token function">proceed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="é€‚é…å™¨æ¨¡å¼çš„ä¼˜åŠ¿">é€‚é…å™¨æ¨¡å¼çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>è§£è€¦</strong>ï¼šå°†æ¥å£è½¬æ¢é€»è¾‘ç‹¬ç«‹å‡ºæ¥ï¼Œä¸ä¿®æ”¹åŸæœ‰ä»£ç </li>
<li><strong>å¤ç”¨</strong>ï¼šæé«˜äº†ç±»çš„å¤ç”¨æ€§</li>
<li><strong>çµæ´»</strong>ï¼šå¯ä»¥çµæ´»åœ°æ·»åŠ æ–°çš„é€‚é…å™¨</li>
</ol>
<h2 id="3-è£…é¥°å™¨æ¨¡å¼-Decorator-Pattern">3. è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼">ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Ÿ</h3>
<p>è£…é¥°å™¨æ¨¡å¼åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°å™¨æ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚</p>
<h3 id="Springä¸­çš„åº”ç”¨">Springä¸­çš„åº”ç”¨</h3>
<p>Springä¸­è£…é¥°å™¨æ¨¡å¼çš„å…¸å‹åº”ç”¨æ˜¯åœ¨Beançš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œèµ„æºå¤„ç†ä¸­ã€‚</p>
<h4 id="3.1-beanwrapperçš„è£…é¥°" tabindex="-1">3.1 BeanWrapperçš„è£…é¥°</h4>
<p><code>BeanWrapper</code>æ˜¯Springä¸­ç”¨äºæ“ä½œBeanå±æ€§çš„å¼ºå¤§å·¥å…·ï¼Œå®ƒé€šè¿‡è£…é¥°å™¨æ¨¡å¼å¢å¼ºäº†åŸºæœ¬çš„å±æ€§è®¿é—®åŠŸèƒ½ã€‚</p>
<p>å…³é”®ç±»ï¼š</p>
<ul>
<li><code>org.springframework.beans.BeanWrapper</code></li>
<li><code>org.springframework.beans.BeanWrapperImpl</code></li>
</ul>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BeanWrapperImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BeanWrapper</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Object</span> wrappedObject<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">BeanWrapper</span> nestedBeanWrapper<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">BeanWrapperImpl</span><span class="token punctuation">(</span><span class="token class-name">Object</span> wrappedObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>wrappedObject <span class="token operator">=</span> wrappedObject<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getWrappedInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wrappedObject<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">getWrappedClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>wrappedObject <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>wrappedObject<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> 
            <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token comment">// è£…é¥°ï¼šæ·»åŠ ç±»å‹è½¬æ¢ã€éªŒè¯ç­‰åŠŸèƒ½</span>
        <span class="token class-name">BeanValueHolder</span> valueHolder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanValueHolder</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PropertyValue</span> pv <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyValue</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">,</span> valueHolder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setPropertyValue</span><span class="token punctuation">(</span>pv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getPropertyValue</span><span class="token punctuation">(</span><span class="token class-name">String</span> propertyName<span class="token punctuation">)</span> 
            <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token comment">// è£…é¥°ï¼šæ·»åŠ ç¼“å­˜ã€ç±»å‹è½¬æ¢ç­‰åŠŸèƒ½</span>
        <span class="token class-name">PropertyTokenHolder</span> tokens <span class="token operator">=</span> <span class="token function">getPropertyNameTokens</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token function">getPropertyValue</span><span class="token punctuation">(</span>tokens<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="3.2-httpservletresponsewrapperçš„è£…é¥°" tabindex="-1">3.2 HttpServletResponseWrapperçš„è£…é¥°</h4>
<p>åœ¨Spring MVCä¸­ï¼Œé€šè¿‡è£…é¥°å™¨æ¨¡å¼åŒ…è£…åŸç”ŸHttpServletResponseå¯¹è±¡ã€‚</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HttpServletResponseWrapper</span> <span class="token keyword">extends</span> <span class="token class-name">ServletResponseWrapper</span> 
        <span class="token keyword">implements</span> <span class="token class-name">HttpServletResponse</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">HttpServletResponseWrapper</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>response <span class="token operator">=</span> response<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addCookie</span><span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">encodeURL</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">encodeURL</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é¢å¤–çš„è£…é¥°åŠŸèƒ½</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCustomHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿">è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>çµæ´»æ‰©å±•</strong>ï¼šå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°æ·»åŠ æˆ–æ’¤é”€åŠŸèƒ½</li>
<li><strong>é¿å…ç±»çˆ†ç‚¸</strong>ï¼šç›¸æ¯”ç»§æ‰¿ï¼Œè£…é¥°å™¨æ¨¡å¼å¯ä»¥é¿å…äº§ç”Ÿå¤§é‡å­ç±»</li>
<li><strong>å•ä¸€èŒè´£</strong>ï¼šæ¯ä¸ªè£…é¥°å™¨åªå…³æ³¨ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½</li>
</ol>
<h2 id="4-å·¥å‚æ¨¡å¼-Factory-Pattern">4. å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰</h2>
<h3 id="ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼">ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼ï¼Ÿ</h3>
<p>å·¥å‚æ¨¡å¼æä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¸ä¼šå¯¹å®¢æˆ·ç«¯æš´éœ²åˆ›å»ºé€»è¾‘ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</p>
<h3 id="Springä¸­çš„åº”ç”¨">Springä¸­çš„åº”ç”¨</h3>
<p>Springæ¡†æ¶æœ¬èº«å°±æ˜¯ä¸€ä¸ªå¤§å‹çš„å·¥å‚ï¼Œ<strong>IoCå®¹å™¨</strong>å°±æ˜¯å·¥å‚æ¨¡å¼çš„å…¸å‹åº”ç”¨ã€‚</p>
<h4 id="4.1-beanfactoryï¼ˆç®€å•å·¥å‚+å·¥å‚æ–¹æ³•ï¼‰" tabindex="-1">4.1 BeanFactoryï¼ˆç®€å•å·¥å‚+å·¥å‚æ–¹æ³•ï¼‰</h4>
<p><code>BeanFactory</code>æ˜¯Springå®¹å™¨çš„æ ¸å¿ƒæ¥å£ï¼Œè´Ÿè´£ç®¡ç†å’Œé…ç½®Beanã€‚</p>
<p>å…³é”®ç±»ï¼š</p>
<ul>
<li><code>org.springframework.beans.factory.BeanFactory</code></li>
<li><code>org.springframework.beans.factory.xml.XmlBeanFactory</code></li>
<li><code>org.springframework.beans.factory.support.DefaultListableBeanFactory</code></li>
</ul>
<pre class="language-java"><code class="language-java"><span class="token comment">// BeanFactoryæ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BeanFactory</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token constant">FACTORY_BEAN_PREFIX</span> <span class="token operator">=</span> <span class="token string">"&amp;"</span><span class="token punctuation">;</span>

    <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">T</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> requiredType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

    <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">T</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> requiredType<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

    <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">containsBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">isPrototype</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">isTypeMatch</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">ResolvableType</span> typeToMatch<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> <span class="token function">isTypeMatch</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> typeToMatch<span class="token punctuation">)</span> 
            <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">getType</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">NoSuchBeanDefinitionException</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getAliases</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// DefaultListableBeanFactoryå®ç°</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DefaultListableBeanFactory</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAutowireCapableBeanFactory</span>
        <span class="token keyword">implements</span> <span class="token class-name">ConfigurableListableBeanFactory</span><span class="token punctuation">,</span> <span class="token class-name">BeanDefinitionRegistry</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span><span class="token punctuation">></span></span> beanDefinitionMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">doGetBean</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token class-name">T</span> <span class="token function">doGetBean</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> requiredType<span class="token punctuation">,</span>
                             <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">,</span> <span class="token keyword">boolean</span> typeCheckOnly<span class="token punctuation">)</span> 
            <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>

        <span class="token comment">// 1. æ£€æŸ¥ç¼“å­˜ä¸­æ˜¯å¦æœ‰å®ä¾‹åŒ–çš„å•ä¾‹Bean</span>
        <span class="token class-name">Object</span> beanInstance <span class="token operator">=</span> <span class="token function">getSingleton</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>beanInstance <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> beanInstance<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 2. è·å–BeanDefinition</span>
        <span class="token class-name">RootBeanDefinition</span> mbd <span class="token operator">=</span> <span class="token function">getMergedLocalBeanDefinition</span><span class="token punctuation">(</span>beanName<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 3. åˆ›å»ºBeanå®ä¾‹</span>
        beanInstance <span class="token operator">=</span> <span class="token function">createBean</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> mbd<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span> beanInstance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinition</span><span class="token punctuation">(</span><span class="token class-name">String</span> beanName<span class="token punctuation">,</span> <span class="token class-name">BeanDefinition</span> beanDefinition<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>beanDefinitionMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>beanName<span class="token punctuation">,</span> beanDefinition<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="4.2-applicationcontextï¼ˆæŠ½è±¡å·¥å‚ï¼‰" tabindex="-1">4.2 ApplicationContextï¼ˆæŠ½è±¡å·¥å‚ï¼‰</h4>
<p><code>ApplicationContext</code>æ˜¯<code>BeanFactory</code>çš„æ‰©å±•ï¼Œæä¾›äº†æ›´å¤šä¼ä¸šçº§ç‰¹æ€§ã€‚</p>
<pre class="language-java"><code class="language-java"><span class="token comment">// ApplicationContextæ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ApplicationContext</span> <span class="token keyword">extends</span> <span class="token class-name">EnvironmentCapable</span><span class="token punctuation">,</span> 
        <span class="token class-name">ListableBeanFactory</span><span class="token punctuation">,</span> <span class="token class-name">HierarchicalBeanFactory</span><span class="token punctuation">,</span>
        <span class="token class-name">MessageSource</span><span class="token punctuation">,</span> <span class="token class-name">ApplicationEventPublisher</span><span class="token punctuation">,</span> <span class="token class-name">ResourcePatternResolver</span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> <span class="token function">getApplicationName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> <span class="token function">getDisplayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">long</span> <span class="token function">getStartupDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">ApplicationContext</span> <span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">AutowireCapableBeanFactory</span> <span class="token function">getAutowireCapableBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ClassPathXmlApplicationContextå®ç°</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassPathXmlApplicationContext</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractXmlApplicationContext</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">String</span> configLocation<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>configLocation<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">ClassPathXmlApplicationContext</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> configLocations<span class="token punctuation">,</span> 
                                          <span class="token keyword">boolean</span> refresh<span class="token punctuation">,</span> 
                                          <span class="token annotation punctuation">@Nullable</span> <span class="token class-name">ApplicationContext</span> parent<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">BeansException</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setConfigLocations</span><span class="token punctuation">(</span>configLocations<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>refresh<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">Resource</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">getConfigResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configLocations<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h4 id="4.3-factorybeanï¼ˆå·¥å‚beanï¼‰" tabindex="-1">4.3 FactoryBeanï¼ˆå·¥å‚Beanï¼‰</h4>
<p><code>FactoryBean</code>æ˜¯Springä¸­ç‰¹æ®Šçš„å·¥å‚Beanæ¥å£ï¼Œç”¨äºåˆ›å»ºå¤æ‚å¯¹è±¡ã€‚</p>
<pre class="language-java"><code class="language-java"><span class="token comment">// FactoryBeanæ¥å£</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>

    <span class="token class-name">String</span> <span class="token constant">OBJECT_TYPE_ATTRIBUTE</span> <span class="token operator">=</span> <span class="token string">"factoryBeanObjectType"</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Nullable</span>
    <span class="token class-name">T</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Nullable</span>
    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç¤ºä¾‹ï¼šä½¿ç”¨FactoryBeanåˆ›å»ºå¤æ‚å¯¹è±¡</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConnectionFactoryBean</span> <span class="token keyword">implements</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Connection</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUrl</span><span class="token punctuation">(</span><span class="token class-name">String</span> url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span><span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Connection</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DriverManager</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Connection</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSingleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ï¼š</p>
<pre class="language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>connection<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.example.ConnectionFactoryBean<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbc:mysql://localhost:3306/test<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>root<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>123456<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
</code></pre>
<h3 id="å·¥å‚æ¨¡å¼çš„ä¼˜åŠ¿">å·¥å‚æ¨¡å¼çš„ä¼˜åŠ¿</h3>
<ol>
<li><strong>è§£è€¦</strong>ï¼šå°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»</li>
<li><strong>çµæ´»</strong>ï¼šå¯ä»¥æ–¹ä¾¿åœ°åˆ‡æ¢ä¸åŒçš„å®ç°</li>
<li><strong>ç»Ÿä¸€ç®¡ç†</strong>ï¼šé›†ä¸­ç®¡ç†å¯¹è±¡çš„åˆ›å»ºé€»è¾‘</li>
<li><strong>å¯æ‰©å±•</strong>ï¼šå®¹æ˜“æ‰©å±•æ–°çš„äº§å“ç±»å‹</li>
</ol>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>Springæ¡†æ¶é€šè¿‡å¯¹è®¾è®¡æ¨¡å¼çš„å·§å¦™è¿ç”¨ï¼Œå®ç°äº†é«˜åº¦çš„å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ï¼š</p>
<table>
<thead>
<tr>
<th>è®¾è®¡æ¨¡å¼</th>
<th>Springåº”ç”¨åœºæ™¯</th>
<th>æ ¸å¿ƒç±»</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä»£ç†æ¨¡å¼</td>
<td>AOPå®ç°ã€äº‹åŠ¡ç®¡ç†</td>
<td>JdkDynamicAopProxyã€CglibAopProxy</td>
</tr>
<tr>
<td>é€‚é…å™¨æ¨¡å¼</td>
<td>MVC Handleré€‚é…ã€AOP Adviceé€‚é…</td>
<td>HandlerAdapterã€AdvisorAdapter</td>
</tr>
<tr>
<td>è£…é¥°å™¨æ¨¡å¼</td>
<td>BeanWrapperã€HttpServletResponseWrapper</td>
<td>BeanWrapperImplã€HttpServletResponseWrapper</td>
</tr>
<tr>
<td>å·¥å‚æ¨¡å¼</td>
<td>IoCå®¹å™¨ã€Beanåˆ›å»º</td>
<td>BeanFactoryã€ApplicationContextã€FactoryBean</td>
</tr>
</tbody>
</table>
<p>å­¦ä¹ Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼åº”ç”¨ï¼Œä¸ä»…èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£Springæ¡†æ¶çš„å·¥ä½œåŸç†ï¼Œæ›´èƒ½æå‡æˆ‘ä»¬è‡ªèº«çš„ä»£ç è®¾è®¡èƒ½åŠ›ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åº”è¯¥æ ¹æ®å…·ä½“åœºæ™¯é€‰æ‹©åˆé€‚çš„è®¾è®¡æ¨¡å¼ï¼Œé¿å…è¿‡åº¦è®¾è®¡ã€‚</p>
<h2 id="å‚è€ƒèµ„æº">å‚è€ƒèµ„æº</h2>
<ul>
<li>Spring Frameworkå®˜æ–¹æ–‡æ¡£</li>
<li>ã€ŠSpringæºç æ·±åº¦è§£æã€‹</li>
<li>ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹</li>
</ul>

          </div>

          <section class="share-section">
            <h3 class="share-title">åˆ†äº«è¿™ç¯‡æ–‡ç« </h3>
            <div class="share-buttons">
              <button class="share-button share-twitter" data-platform="twitter" aria-label="åˆ†äº«åˆ° Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
                <span>Twitter</span>
              </button>
              <button class="share-button share-weibo" data-platform="weibo" aria-label="åˆ†äº«åˆ°å¾®åš">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M10.5 2C6.357 2 3 5.357 3 9.5c0 2.45 1.197 4.627 3.046 5.964-.042.533-.053 1.1.05 1.732.378 2.327 2.48 4.304 5.204 4.304 3.037 0 5.5-2.463 5.5-5.5 0-2.043-1.118-3.827-2.78-4.777.19-.615.3-1.268.3-1.948 0-3.643-2.857-6.5-6.5-6.5zm0 1.5c2.485 0 4.5 2.015 4.5 4.5 0 .405-.065.795-.18 1.167-.55-.125-1.125-.192-1.715-.192-3.59 0-6.5 2.91-6.5 6.5 0 .59.067 1.165.192 1.715-1.247-1.057-2.042-2.635-2.042-4.392 0-3.037 2.463-5.5 5.5-5.5 2.485 0 4.5 2.015 4.5 4.5 0 2.485-2.015 4.5-4.5 4.5-2.485 0-4.5-2.015-4.5-4.5 0-2.485 2.015-4.5 4.5-4.5zm5.5 7c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z"></path></svg>
                <span>å¾®åš</span>
              </button>
              <button class="share-button share-link" data-platform="link" aria-label="å¤åˆ¶é“¾æ¥">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                <span>å¤åˆ¶é“¾æ¥</span>
              </button>
            </div>
            <div class="share-toast" id="shareToast">é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>
          </section>

          
          <section class="comments-section">
            <div class="comments-container">
              <h3 class="comments-title">è¯„è®ºåŒº</h3>
              <div class="giscus-wrapper">
                <script src="https://giscus.app/client.js"
                  data-repo="zhizhi2213/zhizhi2213.github.io"
                  data-repo-id="R_kgDOH-1Z7w"
                  data-category="Announcements"
                  data-category-id="DIC_kwDOH-1Z784CfY7Q"
                  data-mapping="pathname"
                  data-strict="0"
                  data-reactions-enabled="1"
                  data-emit-metadata="0"
                  data-input-position="bottom"
                  data-theme="preferred_color_scheme"
                  data-lang="zh-CN"
                  data-loading="lazy"
                  crossorigin="anonymous"
                  async>
                </script>
              </div>
            </div>
          </section>
          

          <aside class="related-posts">
            <h3 class="related-posts-title">ç›¸å…³æ–‡ç« </h3>
            <ul class="related-posts-list">
              
              <li class="related-posts-item">
                <a href="/static/posts/Spring-IOCä¸AOPè¯¦è§£/" class="related-posts-link">
                  <h4 class="related-posts-item-title">Spring IOCä¸AOPè¯¦è§£</h4>
                  <time class="related-posts-item-date">2026å¹´2æœˆ10æ—¥</time>
                </a>
              </li>
              
              <li class="related-posts-item">
                <a href="/static/posts/MyBatisæºç æ·±åº¦è§£æ/" class="related-posts-link">
                  <h4 class="related-posts-item-title">MyBatisæºç æ·±åº¦è§£æ</h4>
                  <time class="related-posts-item-date">2026å¹´2æœˆ11æ—¥</time>
                </a>
              </li>
              
              <li class="related-posts-item">
                <a href="/static/posts/ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ/" class="related-posts-link">
                  <h4 class="related-posts-item-title">ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ</h4>
                  <time class="related-posts-item-date">2026å¹´2æœˆ11æ—¥</time>
                </a>
              </li>
              
            </ul>
          </aside>
        </article>

        
        <aside class="toc-container">
          <nav class="toc-content" id="tocContent">
            <a href="#ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼" class="toc-item toc-level-2" style="">ä»€ä¹ˆæ˜¯è®¾è®¡æ¨¡å¼ï¼Ÿ</a><a href="#1-ä»£ç†æ¨¡å¼-Proxy-Pattern" class="toc-item toc-level-2" style="">1. ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰</a><a href="#ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼" class="toc-item toc-level-3" style="padding-left: 1.5rem;">ä»€ä¹ˆæ˜¯ä»£ç†æ¨¡å¼ï¼Ÿ</a><a href="#Springä¸­çš„åº”ç”¨" class="toc-item toc-level-3" style="padding-left: 1.5rem;">Springä¸­çš„åº”ç”¨</a><a href="#ä»£ç†æ¨¡å¼çš„ä¼˜åŠ¿" class="toc-item toc-level-3" style="padding-left: 1.5rem;">ä»£ç†æ¨¡å¼çš„ä¼˜åŠ¿</a><a href="#2-é€‚é…å™¨æ¨¡å¼-Adapter-Pattern" class="toc-item toc-level-2" style="">2. é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰</a><a href="#ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼" class="toc-item toc-level-3" style="padding-left: 1.5rem;">ä»€ä¹ˆæ˜¯é€‚é…å™¨æ¨¡å¼ï¼Ÿ</a><a href="#Springä¸­çš„åº”ç”¨" class="toc-item toc-level-3" style="padding-left: 1.5rem;">Springä¸­çš„åº”ç”¨</a><a href="#é€‚é…å™¨æ¨¡å¼çš„ä¼˜åŠ¿" class="toc-item toc-level-3" style="padding-left: 1.5rem;">é€‚é…å™¨æ¨¡å¼çš„ä¼˜åŠ¿</a><a href="#3-è£…é¥°å™¨æ¨¡å¼-Decorator-Pattern" class="toc-item toc-level-2" style="">3. è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰</a><a href="#ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼" class="toc-item toc-level-3" style="padding-left: 1.5rem;">ä»€ä¹ˆæ˜¯è£…é¥°å™¨æ¨¡å¼ï¼Ÿ</a><a href="#Springä¸­çš„åº”ç”¨" class="toc-item toc-level-3" style="padding-left: 1.5rem;">Springä¸­çš„åº”ç”¨</a><a href="#è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿" class="toc-item toc-level-3" style="padding-left: 1.5rem;">è£…é¥°å™¨æ¨¡å¼çš„ä¼˜åŠ¿</a><a href="#4-å·¥å‚æ¨¡å¼-Factory-Pattern" class="toc-item toc-level-2" style="">4. å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰</a><a href="#ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼" class="toc-item toc-level-3" style="padding-left: 1.5rem;">ä»€ä¹ˆæ˜¯å·¥å‚æ¨¡å¼ï¼Ÿ</a><a href="#Springä¸­çš„åº”ç”¨" class="toc-item toc-level-3" style="padding-left: 1.5rem;">Springä¸­çš„åº”ç”¨</a><a href="#å·¥å‚æ¨¡å¼çš„ä¼˜åŠ¿" class="toc-item toc-level-3" style="padding-left: 1.5rem;">å·¥å‚æ¨¡å¼çš„ä¼˜åŠ¿</a><a href="#æ€»ç»“" class="toc-item toc-level-2" style="">æ€»ç»“</a><a href="#å‚è€ƒèµ„æº" class="toc-item toc-level-2" style="">å‚è€ƒèµ„æº</a>
          </nav>
        </aside>
        
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2026 zhizhi2213. All rights reserved.</p>
      <p class="footer-links">
        <a href="/atom.xml" aria-label="RSS è®¢é˜…">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg>
          RSS è®¢é˜…
        </a>
      </p>
    </div>
  </footer>

  <button class="back-to-top" id="backToTop" aria-label="è¿”å›é¡¶éƒ¨">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
  </button>

  <button class="reading-mode-toggle" id="readingModeToggle" aria-label="é˜…è¯»æ¨¡å¼" title="åˆ‡æ¢é˜…è¯»æ¨¡å¼">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>
  </button>

  <script src="/static/assets/script.js" defer></script>
</body>
</html>
