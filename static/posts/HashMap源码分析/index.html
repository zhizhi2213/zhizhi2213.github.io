<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HashMapæºç åˆ†æ - å±å±çš„åšå®¢</title>
  <meta name="description" content="{{post.excerpt}}">
  <link rel="stylesheet" href="/static/assets/style.css">
</head>
<body>
  <div class="background-animation"></div>
  <div class="background-animation background-animation-2"></div>
  
  <header class="header">
    <div class="container">
      <nav class="nav">
        <a href="/" class="logo">å±å±çš„åšå®¢</a>
        <div class="nav-links">
          <a href="/" class="nav-link">é¦–é¡µ</a>
          <a href="/static/archives/" class="nav-link">å½’æ¡£</a>
        </div>
        <button class="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">
          <span class="theme-icon">ğŸŒ™</span>
        </button>
      </nav>
    </div>
  </header>

  <main class="main">
    <div class="container">
      <article class="post">
        <div class="post-header">
          <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
          <h1 class="post-title">HashMapæºç åˆ†æ</h1>
          <div class="post-meta">
            <span class="post-date">2026å¹´2æœˆ9æ—¥</span>
            
          </div>
        </div>
        
        <div class="post-content">
          <h1>HashMap æºç åˆ†æ</h1>
<h2 id="ä¸€ã€hashmap-ç®€ä»‹" tabindex="-1">ä¸€ã€HashMap ç®€ä»‹</h2>
<p>HashMap æ˜¯ Java ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»ä¹‹ä¸€ï¼Œå®ƒåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæä¾›äº†å¿«é€Ÿçš„é”®å€¼å¯¹å­˜å‚¨å’ŒæŸ¥æ‰¾åŠŸèƒ½ã€‚HashMap å…è®¸ä½¿ç”¨ null é”®å’Œ null å€¼ï¼Œå¹¶ä¸”ä¸ä¿è¯æ˜ å°„çš„é¡ºåºã€‚</p>
<h3 id="ä¸»è¦ç‰¹ç‚¹" tabindex="-1">ä¸»è¦ç‰¹ç‚¹</h3>
<ul>
<li>é”®å€¼å¯¹å­˜å‚¨ï¼ŒåŸºäºå“ˆå¸Œè¡¨å®ç°</li>
<li>å…è®¸ null é”®å’Œ null å€¼</li>
<li>éçº¿ç¨‹å®‰å…¨ï¼Œé€‚ç”¨äºå•çº¿ç¨‹ç¯å¢ƒ</li>
<li>é»˜è®¤åˆå§‹å®¹é‡ä¸º 16ï¼Œé»˜è®¤è´Ÿè½½å› å­ä¸º 0.75</li>
<li>æ‰©å®¹æ—¶å®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€</li>
<li>æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡ O(1)ï¼Œæœ€å O(n)</li>
</ul>
<h2 id="äºŒã€æ ¸å¿ƒæ•°æ®ç»“æ„" tabindex="-1">äºŒã€æ ¸å¿ƒæ•°æ®ç»“æ„</h2>
<h3 id="2.1-node-èŠ‚ç‚¹" tabindex="-1">2.1 Node èŠ‚ç‚¹</h3>
<p>HashMap çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª Node å¯¹è±¡ï¼ŒNode æ˜¯ HashMap çš„é™æ€å†…éƒ¨ç±»ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; {
    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;
    <span class="hljs-keyword">final</span> K key;
    V value;
    Node&lt;K,V&gt; next;

    Node(<span class="hljs-type">int</span> hash, K key, V value, Node&lt;K,V&gt; next) {
        <span class="hljs-built_in">this</span>.hash = hash;
        <span class="hljs-built_in">this</span>.key = key;
        <span class="hljs-built_in">this</span>.value = value;
        <span class="hljs-built_in">this</span>.next = next;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> K <span class="hljs-title function_">getKey</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> key; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> value; }
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> key + <span class="hljs-string">&quot;=&quot;</span> + value; }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> {
        <span class="hljs-keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title function_">setValue</span><span class="hljs-params">(V newValue)</span> {
        <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> value;
        value = newValue;
        <span class="hljs-keyword">return</span> oldValue;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> {
        <span class="hljs-keyword">if</span> (o == <span class="hljs-built_in">this</span>)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> Map.Entry) {
            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;
            <span class="hljs-keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;
                Objects.equals(value, e.getValue()))
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
}
</code></pre>
<h3 id="2.2-åº•å±‚ç»“æ„" tabindex="-1">2.2 åº•å±‚ç»“æ„</h3>
<p>HashMap çš„åº•å±‚ç»“æ„æ˜¯ä¸€ä¸ªæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashMap</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractMap</span>&lt;K,V&gt;
    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>&lt;K,V&gt;, Cloneable, Serializable {

    <span class="hljs-keyword">transient</span> Node&lt;K,V&gt;[] table;  <span class="hljs-comment">// å“ˆå¸Œæ¡¶æ•°ç»„</span>

    <span class="hljs-keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;

    <span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> size;  <span class="hljs-comment">// å®é™…å­˜å‚¨çš„é”®å€¼å¯¹æ•°é‡</span>

    <span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> modCount;  <span class="hljs-comment">// ç»“æ„æ€§ä¿®æ”¹æ¬¡æ•°</span>

    <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> loadFactor;  <span class="hljs-comment">// è´Ÿè½½å› å­</span>

    <span class="hljs-type">int</span> threshold;  <span class="hljs-comment">// æ‰©å®¹é˜ˆå€¼ = capacity * loadFactor</span>
}
</code></pre>
<h2 id="ä¸‰ã€å…³é”®å‚æ•°" tabindex="-1">ä¸‰ã€å…³é”®å‚æ•°</h2>
<h3 id="3.1-åˆå§‹å‚æ•°" tabindex="-1">3.1 åˆå§‹å‚æ•°</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_INITIAL_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>;  <span class="hljs-comment">// é»˜è®¤åˆå§‹å®¹é‡ 16</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAXIMUM_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;  <span class="hljs-comment">// æœ€å¤§å®¹é‡</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">DEFAULT_LOAD_FACTOR</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.75f</span>;  <span class="hljs-comment">// é»˜è®¤è´Ÿè½½å› å­</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TREEIFY_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;  <span class="hljs-comment">// é“¾è¡¨è½¬çº¢é»‘æ ‘çš„é˜ˆå€¼</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">UNTREEIFY_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;  <span class="hljs-comment">// çº¢é»‘æ ‘è½¬é“¾è¡¨çš„é˜ˆå€¼</span>
<span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MIN_TREEIFY_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">64</span>;  <span class="hljs-comment">// æ¡¶è½¬æ ‘çš„æœ€å°å®¹é‡</span>
</code></pre>
<h3 id="3.2-æ„é€ æ–¹æ³•" tabindex="-1">3.2 æ„é€ æ–¹æ³•</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">(<span class="hljs-type">int</span> initialCapacity, <span class="hljs-type">float</span> loadFactor)</span> {
    <span class="hljs-keyword">if</span> (initialCapacity &lt; <span class="hljs-number">0</span>)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Illegal initial capacity: &quot;</span> +
                                           initialCapacity);
    <span class="hljs-keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)
        initialCapacity = MAXIMUM_CAPACITY;
    <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> +
                                           loadFactor);
    <span class="hljs-built_in">this</span>.loadFactor = loadFactor;
    <span class="hljs-built_in">this</span>.threshold = tableSizeFor(initialCapacity);
}

<span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">(<span class="hljs-type">int</span> initialCapacity)</span> {
    <span class="hljs-built_in">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);
}

<span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;
}
</code></pre>
<h3 id="3.3-tablesizefor-æ–¹æ³•" tabindex="-1">3.3 tableSizeFor æ–¹æ³•</h3>
<p>è¿™ä¸ªæ–¹æ³•ç”¨äºå°†ç»™å®šçš„å®¹é‡è°ƒæ•´ä¸º 2 çš„ n æ¬¡å¹‚ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tableSizeFor</span><span class="hljs-params">(<span class="hljs-type">int</span> cap)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> cap - <span class="hljs-number">1</span>;
    n |= n &gt;&gt;&gt; <span class="hljs-number">1</span>;
    n |= n &gt;&gt;&gt; <span class="hljs-number">2</span>;
    n |= n &gt;&gt;&gt; <span class="hljs-number">4</span>;
    n |= n &gt;&gt;&gt; <span class="hljs-number">8</span>;
    n |= n &gt;&gt;&gt; <span class="hljs-number">16</span>;
    <span class="hljs-keyword">return</span> (n &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="hljs-number">1</span>;
}
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•é€šè¿‡ä¸€ç³»åˆ—çš„ä½è¿ç®—ï¼Œå°†æœ€é«˜ä½çš„ 1 åé¢çš„æ‰€æœ‰ä½éƒ½ç½®ä¸º 1ï¼Œç„¶ååŠ  1ï¼Œå¾—åˆ°ä¸€ä¸ª 2 çš„ n æ¬¡å¹‚ã€‚</p>
<h2 id="å››ã€hash-ç®—æ³•" tabindex="-1">å››ã€Hash ç®—æ³•</h2>
<h3 id="4.1-hash-æ–¹æ³•" tabindex="-1">4.1 hash æ–¹æ³•</h3>
<p>HashMap é€šè¿‡ hash æ–¹æ³•è®¡ç®— key çš„å“ˆå¸Œå€¼ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hash</span><span class="hljs-params">(Object key)</span> {
    <span class="hljs-type">int</span> h;
    <span class="hljs-keyword">return</span> (key == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="hljs-number">16</span>);
}
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Ÿ</strong></p>
<ul>
<li><code>h &gt;&gt;&gt; 16</code> å°†å“ˆå¸Œå€¼çš„é«˜ 16 ä½æ— ç¬¦å·å³ç§» 16 ä½</li>
<li><code>^</code> æ“ä½œå°†é«˜ 16 ä½å’Œä½ 16 ä½è¿›è¡Œå¼‚æˆ–</li>
<li>è¿™æ ·åšçš„å¥½å¤„æ˜¯è®©é«˜ä½çš„ç‰¹å¾ä¹Ÿèƒ½å‚ä¸åˆ°ä½ä½çš„è¿ç®—ä¸­ï¼Œå‡å°‘å“ˆå¸Œå†²çª</li>
</ul>
<h3 id="4.2-ç´¢å¼•è®¡ç®—" tabindex="-1">4.2 ç´¢å¼•è®¡ç®—</h3>
<p>é€šè¿‡ hash å€¼è®¡ç®—åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ä½ç½®ï¼š</p>
<pre><code class="hljs language-java">index = (n - <span class="hljs-number">1</span>) &amp; hash
</code></pre>
<p>å…¶ä¸­ n æ˜¯æ•°ç»„é•¿åº¦ï¼Œå¿…é¡»æ˜¯ 2 çš„ n æ¬¡å¹‚ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨ä½è¿ç®—è€Œä¸æ˜¯å–æ¨¡ï¼Ÿ</strong></p>
<ul>
<li>ä½è¿ç®—æ•ˆç‡æ›´é«˜</li>
<li>å½“ n æ˜¯ 2 çš„ n æ¬¡å¹‚æ—¶ï¼Œ<code>(n - 1) &amp; hash</code> ç­‰ä»·äº <code>hash % n</code></li>
<li><code>(n - 1)</code> çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯å…¨ 1ï¼Œå¦‚ 16-1=15ï¼ŒäºŒè¿›åˆ¶ä¸º 1111</li>
</ul>
<h2 id="äº”ã€put-æ–¹æ³•æºç åˆ†æ" tabindex="-1">äº”ã€put æ–¹æ³•æºç åˆ†æ</h2>
<h3 id="5.1-put-æ–¹æ³•å…¥å£" tabindex="-1">5.1 put æ–¹æ³•å…¥å£</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span><span class="hljs-params">(K key, V value)</span> {
    <span class="hljs-keyword">return</span> putVal(hash(key), key, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);
}
</code></pre>
<h3 id="5.2-putval-æ–¹æ³•è¯¦è§£" tabindex="-1">5.2 putVal æ–¹æ³•è¯¦è§£</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">final</span> V <span class="hljs-title function_">putVal</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, K key, V value, <span class="hljs-type">boolean</span> onlyIfAbsent,
               <span class="hljs-type">boolean</span> evict)</span> {
    Node&lt;K,V&gt;[] tab;
    Node&lt;K,V&gt; p;
    <span class="hljs-type">int</span> n, i;

    <span class="hljs-comment">// 1. å¦‚æœ table ä¸ºç©ºæˆ–é•¿åº¦ä¸º 0ï¼Œè¿›è¡Œåˆå§‹åŒ–</span>
    <span class="hljs-keyword">if</span> ((tab = table) == <span class="hljs-literal">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)
        n = (tab = resize()).length;

    <span class="hljs-comment">// 2. è®¡ç®—ç´¢å¼•ä½ç½®ï¼Œå¦‚æœè¯¥ä½ç½®ä¸ºç©ºï¼Œç›´æ¥æ’å…¥æ–°èŠ‚ç‚¹</span>
    <span class="hljs-keyword">if</span> ((p = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) == <span class="hljs-literal">null</span>)
        tab[i] = newNode(hash, key, value, <span class="hljs-literal">null</span>);
    <span class="hljs-keyword">else</span> {
        Node&lt;K,V&gt; e;
        K k;

        <span class="hljs-comment">// 3. åˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸è¦æ’å…¥çš„ key ç›¸åŒ</span>
        <span class="hljs-keyword">if</span> (p.hash == hash &amp;&amp;
            ((k = p.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))
            e = p;

        <span class="hljs-comment">// 4. å¦‚æœæ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å…¥æ–¹æ³•</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p <span class="hljs-keyword">instanceof</span> TreeNode)
            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="hljs-built_in">this</span>, tab, hash, key, value);

        <span class="hljs-comment">// 5. å¦åˆ™æ˜¯é“¾è¡¨ï¼Œéå†é“¾è¡¨</span>
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ; ++binCount) {
                <span class="hljs-comment">// åˆ°è¾¾é“¾è¡¨å°¾éƒ¨ï¼Œæ’å…¥æ–°èŠ‚ç‚¹</span>
                <span class="hljs-keyword">if</span> ((e = p.next) == <span class="hljs-literal">null</span>) {
                    p.next = newNode(hash, key, value, <span class="hljs-literal">null</span>);
                    <span class="hljs-comment">// é“¾è¡¨é•¿åº¦è¾¾åˆ° 8ï¼Œè½¬ä¸ºçº¢é»‘æ ‘</span>
                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>)
                        treeifyBin(tab, hash);
                    <span class="hljs-keyword">break</span>;
                }

                <span class="hljs-comment">// æ‰¾åˆ°ç›¸åŒçš„ key</span>
                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;
                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))
                    <span class="hljs-keyword">break</span>;

                p = e;
            }
        }

        <span class="hljs-comment">// 6. å¦‚æœæ‰¾åˆ°ç›¸åŒçš„ keyï¼Œè¦†ç›–æ—§å€¼</span>
        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) {
            <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> e.value;
            <span class="hljs-keyword">if</span> (!onlyIfAbsent || oldValue == <span class="hljs-literal">null</span>)
                e.value = value;
            afterNodeAccess(e);
            <span class="hljs-keyword">return</span> oldValue;
        }
    }

    ++modCount;
    <span class="hljs-comment">// 7. åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span>
    <span class="hljs-keyword">if</span> (++size &gt; threshold)
        resize();
    afterNodeInsertion(evict);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h2 id="å…­ã€get-æ–¹æ³•æºç åˆ†æ" tabindex="-1">å…­ã€get æ–¹æ³•æºç åˆ†æ</h2>
<h3 id="6.1-get-æ–¹æ³•å…¥å£" tabindex="-1">6.1 get æ–¹æ³•å…¥å£</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">public</span> V <span class="hljs-title function_">get</span><span class="hljs-params">(Object key)</span> {
    Node&lt;K,V&gt; e;
    <span class="hljs-keyword">return</span> (e = getNode(hash(key), key)) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : e.value;
}
</code></pre>
<h3 id="6.2-getnode-æ–¹æ³•è¯¦è§£" tabindex="-1">6.2 getNode æ–¹æ³•è¯¦è§£</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title function_">getNode</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, Object key)</span> {
    Node&lt;K,V&gt;[] tab;
    Node&lt;K,V&gt; first, e;
    <span class="hljs-type">int</span> n;
    K k;

    <span class="hljs-comment">// 1. æ£€æŸ¥ table æ˜¯å¦ä¸ºç©º</span>
    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="hljs-number">0</span> &amp;&amp;
        (first = tab[(n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) {

        <span class="hljs-comment">// 2. æ£€æŸ¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦åŒ¹é…</span>
        <span class="hljs-keyword">if</span> (first.hash == hash &amp;&amp;
            ((k = first.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))
            <span class="hljs-keyword">return</span> first;

        <span class="hljs-comment">// 3. æ£€æŸ¥åç»­èŠ‚ç‚¹</span>
        <span class="hljs-keyword">if</span> ((e = first.next) != <span class="hljs-literal">null</span>) {
            <span class="hljs-comment">// å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æŸ¥æ‰¾</span>
            <span class="hljs-keyword">if</span> (first <span class="hljs-keyword">instanceof</span> TreeNode)
                <span class="hljs-keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);

            <span class="hljs-comment">// åœ¨é“¾è¡¨ä¸­æŸ¥æ‰¾</span>
            <span class="hljs-keyword">do</span> {
                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;
                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))
                    <span class="hljs-keyword">return</span> e;
            } <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</code></pre>
<h2 id="ä¸ƒã€æ‰©å®¹æœºåˆ¶ï¼ˆresizeï¼‰" tabindex="-1">ä¸ƒã€æ‰©å®¹æœºåˆ¶ï¼ˆresizeï¼‰</h2>
<h3 id="7.1-resize-æ–¹æ³•è¯¦è§£" tabindex="-1">7.1 resize æ–¹æ³•è¯¦è§£</h3>
<pre><code class="hljs language-java"><span class="hljs-keyword">final</span> Node&lt;K,V&gt;[] resize() {
    Node&lt;K,V&gt;[] oldTab = table;
    <span class="hljs-type">int</span> <span class="hljs-variable">oldCap</span> <span class="hljs-operator">=</span> (oldTab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : oldTab.length;
    <span class="hljs-type">int</span> <span class="hljs-variable">oldThr</span> <span class="hljs-operator">=</span> threshold;
    <span class="hljs-type">int</span> newCap, newThr = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// 1. è®¡ç®—æ–°å®¹é‡å’Œæ–°é˜ˆå€¼</span>
    <span class="hljs-keyword">if</span> (oldCap &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) {
            threshold = Integer.MAX_VALUE;
            <span class="hljs-keyword">return</span> oldTab;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="hljs-number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;
                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)
            newThr = oldThr &lt;&lt; <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldThr &gt; <span class="hljs-number">0</span>)
        newCap = oldThr;
    <span class="hljs-keyword">else</span> {
        newCap = DEFAULT_INITIAL_CAPACITY;
        newThr = (<span class="hljs-type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
    }

    <span class="hljs-keyword">if</span> (newThr == <span class="hljs-number">0</span>) {
        <span class="hljs-type">float</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>)newCap * loadFactor;
        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; MAXIMUM_CAPACITY ?
                  (<span class="hljs-type">int</span>)ft : Integer.MAX_VALUE);
    }
    threshold = newThr;

    <span class="hljs-comment">// 2. åˆ›å»ºæ–°æ•°ç»„</span>
    <span class="hljs-meta">@SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;})</span>
    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>[newCap];
    table = newTab;

    <span class="hljs-comment">// 3. è¿ç§»æ—§æ•°ç»„ä¸­çš„å…ƒç´ </span>
    <span class="hljs-keyword">if</span> (oldTab != <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; oldCap; ++j) {
            Node&lt;K,V&gt; e;
            <span class="hljs-keyword">if</span> ((e = oldTab[j]) != <span class="hljs-literal">null</span>) {
                oldTab[j] = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">if</span> (e.next == <span class="hljs-literal">null</span>)
                    newTab[e.hash &amp; (newCap - <span class="hljs-number">1</span>)] = e;
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> TreeNode)
                    ((TreeNode&lt;K,V&gt;)e).split(<span class="hljs-built_in">this</span>, newTab, j, oldCap);
                <span class="hljs-keyword">else</span> {
                    <span class="hljs-comment">// é“¾è¡¨ä¼˜åŒ–ï¼šå°†é“¾è¡¨åˆ†ä¸ºåŸç´¢å¼•å’ŒåŸç´¢å¼•+oldCapä¸¤ä¸ªä½ç½®</span>
                    Node&lt;K,V&gt; loHead = <span class="hljs-literal">null</span>, loTail = <span class="hljs-literal">null</span>;
                    Node&lt;K,V&gt; hiHead = <span class="hljs-literal">null</span>, hiTail = <span class="hljs-literal">null</span>;
                    Node&lt;K,V&gt; next;
                    <span class="hljs-keyword">do</span> {
                        next = e.next;
                        <span class="hljs-keyword">if</span> ((e.hash &amp; oldCap) == <span class="hljs-number">0</span>) {
                            <span class="hljs-keyword">if</span> (loTail == <span class="hljs-literal">null</span>)
                                loHead = e;
                            <span class="hljs-keyword">else</span>
                                loTail.next = e;
                            loTail = e;
                        }
                        <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">if</span> (hiTail == <span class="hljs-literal">null</span>)
                                hiHead = e;
                            <span class="hljs-keyword">else</span>
                                hiTail.next = e;
                            hiTail = e;
                        }
                    } <span class="hljs-keyword">while</span> ((e = next) != <span class="hljs-literal">null</span>);

                    <span class="hljs-keyword">if</span> (loTail != <span class="hljs-literal">null</span>) {
                        loTail.next = <span class="hljs-literal">null</span>;
                        newTab[j] = loHead;
                    }
                    <span class="hljs-keyword">if</span> (hiTail != <span class="hljs-literal">null</span>) {
                        hiTail.next = <span class="hljs-literal">null</span>;
                        newTab[j + oldCap] = hiHead;
                    }
                }
            }
        }
    }
    <span class="hljs-keyword">return</span> newTab;
}
</code></pre>
<h3 id="7.2-æ‰©å®¹ä¼˜åŒ–" tabindex="-1">7.2 æ‰©å®¹ä¼˜åŒ–</h3>
<p>JDK 1.8 å¯¹æ‰©å®¹è¿›è¡Œäº†ä¼˜åŒ–ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>(e.hash &amp; oldCap)</code> åˆ¤æ–­å…ƒç´ æ˜¯åœ¨åŸä½ç½®è¿˜æ˜¯ç§»åŠ¨åˆ° <code>åŸä½ç½® + oldCap</code></li>
<li>è¿™æ ·å¯ä»¥é¿å…é‡æ–°è®¡ç®— hashï¼Œæé«˜æ•ˆç‡</li>
<li>ä¾‹å¦‚ï¼šåŸå®¹é‡ 16ï¼ˆ10000ï¼‰ï¼Œæ‰©å®¹å 32ï¼ˆ100000ï¼‰
<ul>
<li>å¦‚æœ <code>(e.hash &amp; 16) == 0</code>ï¼Œç´¢å¼•ä¸å˜</li>
<li>å¦‚æœ <code>(e.hash &amp; 16) != 0</code>ï¼Œç´¢å¼• = åŸç´¢å¼• + 16</li>
</ul>
</li>
</ul>
<h2 id="å…«ã€çº¢é»‘æ ‘è½¬æ¢" tabindex="-1">å…«ã€çº¢é»‘æ ‘è½¬æ¢</h2>
<h3 id="8.1-treeifybin-æ–¹æ³•" tabindex="-1">8.1 treeifyBin æ–¹æ³•</h3>
<p>å½“é“¾è¡¨é•¿åº¦è¾¾åˆ° 8 æ—¶ï¼Œå°è¯•å°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">treeifyBin</span><span class="hljs-params">(Node&lt;K,V&gt;[] tab, <span class="hljs-type">int</span> hash)</span> {
    <span class="hljs-type">int</span> n, index;
    Node&lt;K,V&gt; e;

    <span class="hljs-comment">// å¦‚æœæ•°ç»„é•¿åº¦å°äº 64ï¼Œå…ˆæ‰©å®¹è€Œä¸æ˜¯è½¬æ ‘</span>
    <span class="hljs-keyword">if</span> (tab == <span class="hljs-literal">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)
        resize();

    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((e = tab[index = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) {
        TreeNode&lt;K,V&gt; hd = <span class="hljs-literal">null</span>, tl = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">do</span> {
            TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="hljs-literal">null</span>);
            <span class="hljs-keyword">if</span> (tl == <span class="hljs-literal">null</span>)
                hd = p;
            <span class="hljs-keyword">else</span> {
                p.prev = tl;
                tl.next = p;
            }
            tl = p;
        } <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);

        <span class="hljs-keyword">if</span> ((tab[index] = hd) != <span class="hljs-literal">null</span>)
            hd.treeify(tab);
    }
}
</code></pre>
<h3 id="8.2-ä¸ºä»€ä¹ˆæ˜¯-8-å’Œ-6ï¼Ÿ" tabindex="-1">8.2 ä¸ºä»€ä¹ˆæ˜¯ 8 å’Œ 6ï¼Ÿ</h3>
<ul>
<li><strong>8 è½¬ 16</strong>ï¼šé“¾è¡¨è½¬çº¢é»‘æ ‘</li>
<li><strong>6 è½¬ 16</strong>ï¼šçº¢é»‘æ ‘è½¬é“¾è¡¨</li>
</ul>
<p>è¿™æ ·è®¾è®¡æ˜¯ä¸ºäº†é¿å…é¢‘ç¹è½¬æ¢ï¼š</p>
<ul>
<li>æ ¹æ®æ³Šæ¾åˆ†å¸ƒï¼Œé“¾è¡¨é•¿åº¦è¾¾åˆ° 8 çš„æ¦‚ç‡éå¸¸å°ï¼ˆ0.00000006ï¼‰</li>
<li>å½“é•¿åº¦åœ¨ 6-8 ä¹‹é—´æ³¢åŠ¨æ—¶ï¼Œä¸ä¼šé¢‘ç¹è½¬æ¢</li>
<li>è¿™æ˜¯ä¸€ç§ç©ºé—´å’Œæ—¶é—´çš„æƒè¡¡</li>
</ul>
<h2 id="ä¹ã€çº¿ç¨‹å®‰å…¨é—®é¢˜" tabindex="-1">ä¹ã€çº¿ç¨‹å®‰å…¨é—®é¢˜</h2>
<p>HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š</p>
<h3 id="9.1-å¹¶å‘æ‰©å®¹é—®é¢˜" tabindex="-1">9.1 å¹¶å‘æ‰©å®¹é—®é¢˜</h3>
<p>JDK 1.7 ä¸­ä½¿ç”¨å¤´æ’æ³•ï¼Œå¹¶å‘æ‰©å®¹å¯èƒ½å¯¼è‡´é“¾è¡¨å½¢æˆç¯ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">transfer</span><span class="hljs-params">(Entry[] newTable, <span class="hljs-type">boolean</span> rehash)</span> {
    <span class="hljs-type">int</span> <span class="hljs-variable">newCapacity</span> <span class="hljs-operator">=</span> newTable.length;
    <span class="hljs-keyword">for</span> (Entry&lt;K,V&gt; e : table) {
        <span class="hljs-keyword">while</span>(<span class="hljs-literal">null</span> != e) {
            Entry&lt;K,V&gt; next = e.next;
            <span class="hljs-keyword">if</span> (rehash) {
                e.hash = <span class="hljs-literal">null</span> == e.key ? <span class="hljs-number">0</span> : hash(e.key);
            }
            <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> indexFor(e.hash, newCapacity);
            e.next = newTable[i];
            newTable[i] = e;
            e = next;
        }
    }
}
</code></pre>
<h3 id="9.2-jdk-1.8-çš„æ”¹è¿›" tabindex="-1">9.2 JDK 1.8 çš„æ”¹è¿›</h3>
<ul>
<li>æ”¹ç”¨å°¾æ’æ³•ï¼Œé¿å…äº†é“¾è¡¨ç¯çš„é—®é¢˜</li>
<li>ä½†ä»ç„¶å­˜åœ¨æ•°æ®ä¸¢å¤±å’Œè¦†ç›–çš„é—®é¢˜</li>
</ul>
<h3 id="9.3-è§£å†³æ–¹æ¡ˆ" tabindex="-1">9.3 è§£å†³æ–¹æ¡ˆ</h3>
<p>å¦‚æœéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<ul>
<li><strong>ConcurrentHashMap</strong>ï¼šçº¿ç¨‹å®‰å…¨çš„ HashMap</li>
<li><strong>Collections.synchronizedMap(new HashMap&lt;&gt;())</strong>ï¼šä½¿ç”¨åŒæ­¥åŒ…è£…å™¨</li>
<li><strong>Hashtable</strong>ï¼šçº¿ç¨‹å®‰å…¨çš„é—ç•™ç±»ï¼ˆä¸æ¨èï¼‰</li>
</ul>
<h2 id="åã€å¸¸è§é¢è¯•é¢˜" tabindex="-1">åã€å¸¸è§é¢è¯•é¢˜</h2>
<h3 id="1.-hashmap-çš„åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ" tabindex="-1">1. HashMap çš„åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h3>
<p>JDK 1.7ï¼šæ•°ç»„ + é“¾è¡¨<br>
JDK 1.8ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</p>
<h3 id="2.-ä¸ºä»€ä¹ˆ-jdk-1.8-è¦å¼•å…¥çº¢é»‘æ ‘ï¼Ÿ" tabindex="-1">2. ä¸ºä»€ä¹ˆ JDK 1.8 è¦å¼•å…¥çº¢é»‘æ ‘ï¼Ÿ</h3>
<p>ä¸ºäº†è§£å†³é“¾è¡¨è¿‡é•¿å¯¼è‡´çš„æŸ¥è¯¢æ•ˆç‡é—®é¢˜ã€‚å½“é“¾è¡¨é•¿åº¦è¶…è¿‡ 8 æ—¶ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä» O(n) é™ä½åˆ° O(log n)ã€‚</p>
<h3 id="3.-hashmap-çš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ" tabindex="-1">3. HashMap çš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li>å½“ size &gt; thresholdï¼ˆcapacity * loadFactorï¼‰æ—¶è§¦å‘æ‰©å®¹</li>
<li>æ‰©å®¹åå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€</li>
<li>æ‰©å®¹æ—¶éœ€è¦é‡æ–°è®¡ç®—æ‰€æœ‰å…ƒç´ çš„ä½ç½®ï¼ˆJDK 1.8 æœ‰ä¼˜åŒ–ï¼‰</li>
</ul>
<h3 id="4.-ä¸ºä»€ä¹ˆ-hashmap-çš„å®¹é‡å¿…é¡»æ˜¯-2-çš„-n-æ¬¡å¹‚ï¼Ÿ" tabindex="-1">4. ä¸ºä»€ä¹ˆ HashMap çš„å®¹é‡å¿…é¡»æ˜¯ 2 çš„ n æ¬¡å¹‚ï¼Ÿ</h3>
<ul>
<li>æ–¹ä¾¿ä½¿ç”¨ä½è¿ç®—ä»£æ›¿å–æ¨¡è¿ç®—ï¼Œæé«˜æ•ˆç‡</li>
<li>ä½¿ hash åˆ†å¸ƒæ›´å‡åŒ€</li>
<li>ä¾¿äºæ‰©å®¹æ—¶çš„å…ƒç´ è¿ç§»</li>
</ul>
<h3 id="5.-hashmap-çš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯-0.75ï¼Ÿ" tabindex="-1">5. HashMap çš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯ 0.75ï¼Ÿ</h3>
<p>è¿™æ˜¯æ—¶é—´å’Œç©ºé—´çš„æƒè¡¡ï¼š</p>
<ul>
<li>å¤ªå°ï¼šç©ºé—´åˆ©ç”¨ç‡ä½ï¼Œé¢‘ç¹æ‰©å®¹</li>
<li>å¤ªå¤§ï¼šå“ˆå¸Œå†²çªå¢å¤šï¼ŒæŸ¥è¯¢æ•ˆç‡é™ä½</li>
<li>0.75 æ˜¯ç»è¿‡æ•°å­¦è®¡ç®—çš„æœ€ä¼˜å€¼</li>
</ul>
<h3 id="6.-hashmap-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ" tabindex="-1">6. HashMap æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</h3>
<p>ä¸æ˜¯ï¼ŒHashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå­˜åœ¨ï¼š</p>
<ul>
<li>æ•°æ®ä¸¢å¤±</li>
<li>æ•°æ®è¦†ç›–</li>
<li>JDK 1.7 å¯èƒ½å‡ºç°æ­»å¾ªç¯</li>
</ul>
<h3 id="7.-hashmap-ä¸­-key-ä¸º-null-æ—¶æ€ä¹ˆå¤„ç†ï¼Ÿ" tabindex="-1">7. HashMap ä¸­ key ä¸º null æ—¶æ€ä¹ˆå¤„ç†ï¼Ÿ</h3>
<p>HashMap å…è®¸ä¸€ä¸ª null é”®ï¼Œnull é”®çš„ hash å€¼ä¸º 0ï¼Œå­˜æ”¾åœ¨æ•°ç»„çš„ç¬¬ 0 ä¸ªä½ç½®ã€‚</p>
<h3 id="8.-hashmap-å’Œ-concurrenthashmap-çš„åŒºåˆ«ï¼Ÿ" tabindex="-1">8. HashMap å’Œ ConcurrentHashMap çš„åŒºåˆ«ï¼Ÿ</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>HashMap</th>
<th>ConcurrentHashMap</th>
</tr>
</thead>
<tbody>
<tr>
<td>çº¿ç¨‹å®‰å…¨</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>å®ç°æ–¹å¼</td>
<td>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</td>
<td>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ + CAS + synchronized</td>
</tr>
<tr>
<td>null é”®å€¼</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
</tr>
<tr>
<td>è¿­ä»£å™¨</td>
<td>fail-fast</td>
<td>weakly consistent</td>
</tr>
</tbody>
</table>
<h3 id="9.-hashmap-å’Œ-hashtable-çš„åŒºåˆ«ï¼Ÿ" tabindex="-1">9. HashMap å’Œ Hashtable çš„åŒºåˆ«ï¼Ÿ</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>HashMap</th>
<th>Hashtable</th>
</tr>
</thead>
<tbody>
<tr>
<td>çº¿ç¨‹å®‰å…¨</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>null é”®å€¼</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
</tr>
<tr>
<td>ç»§æ‰¿</td>
<td>AbstractMap</td>
<td>Dictionary</td>
</tr>
<tr>
<td>æ•ˆç‡</td>
<td>é«˜</td>
<td>ä½</td>
</tr>
</tbody>
</table>
<h3 id="10.-å¦‚ä½•ä¼˜åŒ–-hashmap-çš„æ€§èƒ½ï¼Ÿ" tabindex="-1">10. å¦‚ä½•ä¼˜åŒ– HashMap çš„æ€§èƒ½ï¼Ÿ</h3>
<ul>
<li>è®¾ç½®åˆé€‚çš„åˆå§‹å®¹é‡ï¼Œé¿å…é¢‘ç¹æ‰©å®¹</li>
<li>é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­</li>
<li>ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ä½œä¸º key</li>
<li>é‡å†™ hashCode å’Œ equals æ–¹æ³•</li>
</ul>
<h2 id="åä¸€ã€ä½¿ç”¨å»ºè®®" tabindex="-1">åä¸€ã€ä½¿ç”¨å»ºè®®</h2>
<h3 id="11.1-åˆå§‹åŒ–å®¹é‡" tabindex="-1">11.1 åˆå§‹åŒ–å®¹é‡</h3>
<p>å¦‚æœçŸ¥é“å¤§æ¦‚çš„å…ƒç´ æ•°é‡ï¼Œå¯ä»¥è®¾ç½®åˆå§‹å®¹é‡ï¼š</p>
<pre><code class="hljs language-java"><span class="hljs-type">int</span> <span class="hljs-variable">expectedSize</span> <span class="hljs-operator">=</span> <span class="hljs-number">10000</span>;
HashMap&lt;String, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(expectedSize * <span class="hljs-number">4</span> / <span class="hljs-number">3</span> + <span class="hljs-number">1</span>);
</code></pre>
<h3 id="11.2-é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­" tabindex="-1">11.2 é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­</h3>
<p>é»˜è®¤ 0.75 é€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼Œå¦‚æœï¼š</p>
<ul>
<li>å†…å­˜ç´§å¼ ï¼šå¯ä»¥å¢å¤§è´Ÿè½½å› å­ï¼ˆå¦‚ 0.85ï¼‰</li>
<li>æŸ¥è¯¢æ€§èƒ½è¦æ±‚é«˜ï¼šå¯ä»¥å‡å°è´Ÿè½½å› å­ï¼ˆå¦‚ 0.5ï¼‰</li>
</ul>
<h3 id="11.3-é¿å…å¤§å¯¹è±¡ä½œä¸º-key" tabindex="-1">11.3 é¿å…å¤§å¯¹è±¡ä½œä¸º key</h3>
<p>å¤§å¯¹è±¡çš„ hashCode è®¡ç®—æˆæœ¬é«˜ï¼Œå»ºè®®ä½¿ç”¨ï¼š</p>
<ul>
<li>åŸºæœ¬ç±»å‹åŒ…è£…ç±»</li>
<li>String</li>
<li>è‡ªå®šä¹‰çš„ä¸å¯å˜å¯¹è±¡</li>
</ul>
<h2 id="åäºŒã€æ€»ç»“" tabindex="-1">åäºŒã€æ€»ç»“</h2>
<p>HashMap æ˜¯ Java é›†åˆæ¡†æ¶ä¸­æœ€é‡è¦çš„ç±»ä¹‹ä¸€ï¼Œå…¶è®¾è®¡ä½“ç°äº†ä»¥ä¸‹æ€æƒ³ï¼š</p>
<ol>
<li><strong>å“ˆå¸Œè¡¨çš„ç²¾å¦™è®¾è®¡</strong>ï¼šé€šè¿‡ hash ç®—æ³•å’Œä½è¿ç®—å®ç°å¿«é€ŸæŸ¥æ‰¾</li>
<li><strong>åŠ¨æ€æ‰©å®¹æœºåˆ¶</strong>ï¼šå¹³è¡¡äº†æ—¶é—´å’Œç©ºé—´çš„æ•ˆç‡</li>
<li><strong>çº¢é»‘æ ‘ä¼˜åŒ–</strong>ï¼šè§£å†³äº†é“¾è¡¨è¿‡é•¿çš„é—®é¢˜</li>
<li><strong>ä½è¿ç®—ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ä½è¿ç®—ä»£æ›¿å–æ¨¡ï¼Œæé«˜æ•ˆç‡</li>
</ol>
<p>ç†è§£ HashMap çš„æºç ä¸ä»…æœ‰åŠ©äºé¢è¯•ï¼Œæ›´èƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç ã€‚</p>

        </div>
      </article>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2026 zhizhi2213. All rights reserved.</p>
    </div>
  </footer>

  <script src="/static/assets/script.js"></script>
</body>
</html>
