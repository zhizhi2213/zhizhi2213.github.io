<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HashMapæºç åˆ†æ - å±å±çš„åšå®¢</title>
  <meta name="description" content="HashMap æºç åˆ†æ

 ä¸€ã€HashMap ç®€ä»‹

HashMap æ˜¯ Java ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»ä¹‹ä¸€ï¼Œå®ƒåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæä¾›äº†å¿«é€Ÿçš„é”®å€¼å¯¹å­˜å‚¨å’ŒæŸ¥æ‰¾åŠŸèƒ½ã€‚HashMap å…è®¸ä½¿ç”¨ null é”®å’Œ null å€¼ï¼Œå¹¶ä¸”ä¸ä¿è¯æ˜ å°„çš„é¡ºåºã€‚

 ä¸»è¦ç‰¹ç‚¹

- é”®å€¼å¯¹å­˜å‚¨ï¼ŒåŸºäºå“ˆå¸Œè¡¨å®ç°
- å…è®¸ ...">
  <meta name="theme-color" content="#6366f1">
  <meta property="og:title" content="HashMapæºç åˆ†æ">
  <meta property="og:description" content="HashMap æºç åˆ†æ

 ä¸€ã€HashMap ç®€ä»‹

HashMap æ˜¯ Java ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»ä¹‹ä¸€ï¼Œå®ƒåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæä¾›äº†å¿«é€Ÿçš„é”®å€¼å¯¹å­˜å‚¨å’ŒæŸ¥æ‰¾åŠŸèƒ½ã€‚HashMap å…è®¸ä½¿ç”¨ null é”®å’Œ null å€¼ï¼Œå¹¶ä¸”ä¸ä¿è¯æ˜ å°„çš„é¡ºåºã€‚

 ä¸»è¦ç‰¹ç‚¹

- é”®å€¼å¯¹å­˜å‚¨ï¼ŒåŸºäºå“ˆå¸Œè¡¨å®ç°
- å…è®¸ ...">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://zhizhi2213.github.io/static/posts/HashMapæºç åˆ†æ/">
  <meta property="og:site_name" content="å±å±çš„åšå®¢">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:author" content="zhizhi2213">
  <meta property="article:published_time" content="2026å¹´2æœˆ9æ—¥">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="HashMapæºç åˆ†æ">
  <meta name="twitter:description" content="HashMap æºç åˆ†æ

 ä¸€ã€HashMap ç®€ä»‹

HashMap æ˜¯ Java ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»ä¹‹ä¸€ï¼Œå®ƒåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæä¾›äº†å¿«é€Ÿçš„é”®å€¼å¯¹å­˜å‚¨å’ŒæŸ¥æ‰¾åŠŸèƒ½ã€‚HashMap å…è®¸ä½¿ç”¨ null é”®å’Œ null å€¼ï¼Œå¹¶ä¸”ä¸ä¿è¯æ˜ å°„çš„é¡ºåºã€‚

 ä¸»è¦ç‰¹ç‚¹

- é”®å€¼å¯¹å­˜å‚¨ï¼ŒåŸºäºå“ˆå¸Œè¡¨å®ç°
- å…è®¸ ...">
  <link rel="stylesheet" href="/static/assets/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
</head>
<body>
  <div class="background-animation"></div>
  <div class="background-animation background-animation-2"></div>
  
  <div class="reading-progress-bar" id="readingProgressBar"></div>
  
  <a href="#main-content" class="skip-link">è·³è½¬åˆ°ä¸»è¦å†…å®¹</a>
  
  <header class="header">
    <div class="container">
      <nav class="nav">
        <a href="/" class="logo">å±å±çš„åšå®¢</a>
        <div class="nav-links">
          <a href="/" class="nav-link">é¦–é¡µ</a>
          <a href="/static/archives/" class="nav-link">å½’æ¡£</a>
          <a href="/static/tags/" class="nav-link">æ ‡ç­¾</a>
        </div>
        <div class="header-actions">
          <button class="search-toggle" aria-label="æœç´¢">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
          </button>
          <button class="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">
            <span class="theme-icon">ğŸŒ™</span>
          </button>
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="æ‰“å¼€èœå•">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
          </button>
        </div>
      </nav>
      
      <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-backdrop" id="mobileMenuBackdrop"></div>
        <div class="mobile-menu-content">
          <div class="mobile-menu-header">
            <a href="/" class="logo">å±å±çš„åšå®¢</a>
            <button class="mobile-menu-close" id="mobileMenuClose" aria-label="å…³é—­èœå•">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
          </div>
          <div class="mobile-menu-links">
            <a href="/" class="mobile-menu-link">é¦–é¡µ</a>
            <a href="/static/archives/" class="mobile-menu-link">å½’æ¡£</a>
            <a href="/static/tags/" class="mobile-menu-link">æ ‡ç­¾</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="search-modal" id="searchModal">
    <div class="search-modal-backdrop" id="searchBackdrop"></div>
    <div class="search-modal-content">
      <div class="search-header">
        <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢æ–‡ç« ..." autocomplete="off">
        <button class="search-close" id="searchClose" aria-label="å…³é—­æœç´¢">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
      </div>
      <div class="search-results" id="searchResults"></div>
    </div>
  </div>

  <main class="main" id="main-content">
    <div class="post-layout-container">
      <div class="post-layout">
        <aside class="posts-sidebar">
          <h3 class="posts-sidebar-title">æ–‡ç« ç›®å½•</h3>
          <nav class="posts-sidebar-content" id="postsSidebarContent">
            <ul class="posts-sidebar-list">
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/MyBatisæºç æ·±åº¦è§£æ/" class="posts-sidebar-link">MyBatisæºç æ·±åº¦è§£æ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ/" class="posts-sidebar-link">ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/Spring-IOCä¸AOPè¯¦è§£/" class="posts-sidebar-link">Spring IOCä¸AOPè¯¦è§£</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£/" class="posts-sidebar-link">Springæºç ä¸­çš„è®¾è®¡æ¨¡å¼è¯¦è§£</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/HashMapæºç åˆ†æ/" class="posts-sidebar-link active">HashMapæºç åˆ†æ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/javaè¯­æ³•ç³–è¯¦è§£/" class="posts-sidebar-link">javaè¯­æ³•ç³–è¯¦è§£</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/Trae-Javaç¯å¢ƒé…ç½®/" class="posts-sidebar-link">Trae-Javaç¯å¢ƒé…ç½®</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢/" class="posts-sidebar-link">æ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/ä¸ºä»€ä¹ˆJavaä¸­åªæœ‰å€¼ä¼ é€’/" class="posts-sidebar-link">ä¸ºä»€ä¹ˆJavaä¸­åªæœ‰å€¼ä¼ é€’ï¼Ÿ</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/å…³äºæŠ€æœ¯åˆ†äº«/" class="posts-sidebar-link">å…³äºæŠ€æœ¯åˆ†äº«</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/ä»£ç ä¹‹ç¾/" class="posts-sidebar-link">ä»£ç ä¹‹ç¾</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/é¦–é¡µç¾åŒ–æ•™ç¨‹/" class="posts-sidebar-link">é¦–é¡µç¾åŒ–æ•™ç¨‹</a>
              </li>
              
              <li class="posts-sidebar-item">
                <a href="/static/posts/å¦‚ä½•åˆ›å»ºGitHubä¸ªäººç½‘ç«™/" class="posts-sidebar-link">å¦‚ä½•åˆ›å»ºGitHubä¸ªäººç½‘ç«™</a>
              </li>
              
            </ul>
          </nav>
        </aside>

        <article class="post">
          <div class="post-header">
            <a href="/" class="back-link">â† è¿”å›é¦–é¡µ</a>
            <h1 class="post-title">HashMapæºç åˆ†æ</h1>
            <div class="post-meta">
              <span class="post-date">2026å¹´2æœˆ9æ—¥</span>
              <span class="post-views" id="postViews">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                <span>åŠ è½½ä¸­...</span>
              </span>
              
            </div>
          </div>

          <div class="post-content">
            <h1>HashMap æºç åˆ†æ</h1>
<h2 id="ä¸€-HashMap-ç®€ä»‹">ä¸€ã€HashMap ç®€ä»‹</h2>
<p>HashMap æ˜¯ Java ä¸­æœ€å¸¸ç”¨çš„é›†åˆç±»ä¹‹ä¸€ï¼Œå®ƒåŸºäºå“ˆå¸Œè¡¨å®ç°ï¼Œæä¾›äº†å¿«é€Ÿçš„é”®å€¼å¯¹å­˜å‚¨å’ŒæŸ¥æ‰¾åŠŸèƒ½ã€‚HashMap å…è®¸ä½¿ç”¨ null é”®å’Œ null å€¼ï¼Œå¹¶ä¸”ä¸ä¿è¯æ˜ å°„çš„é¡ºåºã€‚</p>
<h3 id="ä¸»è¦ç‰¹ç‚¹">ä¸»è¦ç‰¹ç‚¹</h3>
<ul>
<li>é”®å€¼å¯¹å­˜å‚¨ï¼ŒåŸºäºå“ˆå¸Œè¡¨å®ç°</li>
<li>å…è®¸ null é”®å’Œ null å€¼</li>
<li>éçº¿ç¨‹å®‰å…¨ï¼Œé€‚ç”¨äºå•çº¿ç¨‹ç¯å¢ƒ</li>
<li>é»˜è®¤åˆå§‹å®¹é‡ä¸º 16ï¼Œé»˜è®¤è´Ÿè½½å› å­ä¸º 0.75</li>
<li>æ‰©å®¹æ—¶å®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€</li>
<li>æ—¶é—´å¤æ‚åº¦ï¼šå¹³å‡ O(1)ï¼Œæœ€å O(n)</li>
</ul>
<h2 id="äºŒ-æ ¸å¿ƒæ•°æ®ç»“æ„">äºŒã€æ ¸å¿ƒæ•°æ®ç»“æ„</h2>
<h3 id="2-1-Node-èŠ‚ç‚¹">2.1 Node èŠ‚ç‚¹</h3>
<p>HashMap çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ª Node å¯¹è±¡ï¼ŒNode æ˜¯ HashMap çš„é™æ€å†…éƒ¨ç±»ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token keyword">implements</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> <span class="token keyword">int</span> hash<span class="token punctuation">;</span>
    <span class="token keyword">final</span> <span class="token class-name">K</span> key<span class="token punctuation">;</span>
    <span class="token class-name">V</span> value<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">;</span>

    <span class="token class-name">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>hash <span class="token operator">=</span> hash<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>next <span class="token operator">=</span> next<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">K</span> <span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> key<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> key <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">setValue</span><span class="token punctuation">(</span><span class="token class-name">V</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">V</span> oldValue <span class="token operator">=</span> value<span class="token punctuation">;</span>
        value <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
        <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">></span></span> e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">,</span><span class="token operator">?</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>o<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span>
                <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="2-2-åº•å±‚ç»“æ„">2.2 åº•å±‚ç»“æ„</h3>
<p>HashMap çš„åº•å±‚ç»“æ„æ˜¯ä¸€ä¸ªæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span>
    <span class="token keyword">implements</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">,</span> <span class="token class-name">Cloneable</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">transient</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>  <span class="token comment">// å“ˆå¸Œæ¡¶æ•°ç»„</span>

    <span class="token keyword">transient</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span><span class="token punctuation">></span></span> entrySet<span class="token punctuation">;</span>

    <span class="token keyword">transient</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>  <span class="token comment">// å®é™…å­˜å‚¨çš„é”®å€¼å¯¹æ•°é‡</span>

    <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span>  <span class="token comment">// ç»“æ„æ€§ä¿®æ”¹æ¬¡æ•°</span>

    <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span>  <span class="token comment">// è´Ÿè½½å› å­</span>

    <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>  <span class="token comment">// æ‰©å®¹é˜ˆå€¼ = capacity * loadFactor</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="ä¸‰-å…³é”®å‚æ•°">ä¸‰ã€å…³é”®å‚æ•°</h2>
<h3 id="3-1-åˆå§‹å‚æ•°">3.1 åˆå§‹å‚æ•°</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span>  <span class="token comment">// é»˜è®¤åˆå§‹å®¹é‡ 16</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>  <span class="token comment">// æœ€å¤§å®¹é‡</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> <span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>  <span class="token comment">// é»˜è®¤è´Ÿè½½å› å­</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>  <span class="token comment">// é“¾è¡¨è½¬çº¢é»‘æ ‘çš„é˜ˆå€¼</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">UNTREEIFY_THRESHOLD</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>  <span class="token comment">// çº¢é»‘æ ‘è½¬é“¾è¡¨çš„é˜ˆå€¼</span>
<span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">MIN_TREEIFY_CAPACITY</span> <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>  <span class="token comment">// æ¡¶è½¬æ ‘çš„æœ€å°å®¹é‡</span>
</code></pre>
<h3 id="3-2-æ„é€ æ–¹æ³•">3.2 æ„é€ æ–¹æ³•</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal initial capacity: "</span> <span class="token operator">+</span>
                                           initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">></span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span>
        initialCapacity <span class="token operator">=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>loadFactor <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token operator">||</span> <span class="token class-name">Float</span><span class="token punctuation">.</span><span class="token function">isNaN</span><span class="token punctuation">(</span>loadFactor<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal load factor: "</span> <span class="token operator">+</span>
                                           loadFactor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> loadFactor<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>threshold <span class="token operator">=</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">,</span> <span class="token constant">DEFAULT_LOAD_FACTOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> <span class="token constant">DEFAULT_LOAD_FACTOR</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="3-3-tableSizeFor-æ–¹æ³•">3.3 tableSizeFor æ–¹æ³•</h3>
<p>è¿™ä¸ªæ–¹æ³•ç”¨äºå°†ç»™å®šçš„å®¹é‡è°ƒæ•´ä¸º 2 çš„ n æ¬¡å¹‚ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> cap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">2</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">8</span><span class="token punctuation">;</span>
    n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">:</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>è¿™ä¸ªæ–¹æ³•é€šè¿‡ä¸€ç³»åˆ—çš„ä½è¿ç®—ï¼Œå°†æœ€é«˜ä½çš„ 1 åé¢çš„æ‰€æœ‰ä½éƒ½ç½®ä¸º 1ï¼Œç„¶ååŠ  1ï¼Œå¾—åˆ°ä¸€ä¸ª 2 çš„ n æ¬¡å¹‚ã€‚</p>
<h2 id="å››-Hash-ç®—æ³•">å››ã€Hash ç®—æ³•</h2>
<h3 id="4-1-hash-æ–¹æ³•">4.1 hash æ–¹æ³•</h3>
<p>HashMap é€šè¿‡ hash æ–¹æ³•è®¡ç®— key çš„å“ˆå¸Œå€¼ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> h<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿›è¡Œå¼‚æˆ–æ“ä½œï¼Ÿ</strong></p>
<ul>
<li><code>h &gt;&gt;&gt; 16</code> å°†å“ˆå¸Œå€¼çš„é«˜ 16 ä½æ— ç¬¦å·å³ç§» 16 ä½</li>
<li><code>^</code> æ“ä½œå°†é«˜ 16 ä½å’Œä½ 16 ä½è¿›è¡Œå¼‚æˆ–</li>
<li>è¿™æ ·åšçš„å¥½å¤„æ˜¯è®©é«˜ä½çš„ç‰¹å¾ä¹Ÿèƒ½å‚ä¸åˆ°ä½ä½çš„è¿ç®—ä¸­ï¼Œå‡å°‘å“ˆå¸Œå†²çª</li>
</ul>
<h3 id="4-2-ç´¢å¼•è®¡ç®—">4.2 ç´¢å¼•è®¡ç®—</h3>
<p>é€šè¿‡ hash å€¼è®¡ç®—åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ä½ç½®ï¼š</p>
<pre class="language-java"><code class="language-java">index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash
</code></pre>
<p>å…¶ä¸­ n æ˜¯æ•°ç»„é•¿åº¦ï¼Œå¿…é¡»æ˜¯ 2 çš„ n æ¬¡å¹‚ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆä½¿ç”¨ä½è¿ç®—è€Œä¸æ˜¯å–æ¨¡ï¼Ÿ</strong></p>
<ul>
<li>ä½è¿ç®—æ•ˆç‡æ›´é«˜</li>
<li>å½“ n æ˜¯ 2 çš„ n æ¬¡å¹‚æ—¶ï¼Œ<code>(n - 1) &amp; hash</code> ç­‰ä»·äº <code>hash % n</code></li>
<li><code>(n - 1)</code> çš„äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯å…¨ 1ï¼Œå¦‚ 16-1=15ï¼ŒäºŒè¿›åˆ¶ä¸º 1111</li>
</ul>
<h2 id="äº”-put-æ–¹æ³•æºç åˆ†æ">äº”ã€put æ–¹æ³•æºç åˆ†æ</h2>
<h3 id="5-1-put-æ–¹æ³•å…¥å£">5.1 put æ–¹æ³•å…¥å£</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">put</span><span class="token punctuation">(</span><span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="5-2-putVal-æ–¹æ³•è¯¦è§£">5.2 putVal æ–¹æ³•è¯¦è§£</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">V</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">K</span> key<span class="token punctuation">,</span> <span class="token class-name">V</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span>
               <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> p<span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>

    <span class="token comment">// 1. å¦‚æœ table ä¸ºç©ºæˆ–é•¿åº¦ä¸º 0ï¼Œè¿›è¡Œåˆå§‹åŒ–</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
        n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

    <span class="token comment">// 2. è®¡ç®—ç´¢å¼•ä½ç½®ï¼Œå¦‚æœè¯¥ä½ç½®ä¸ºç©ºï¼Œç›´æ¥æ’å…¥æ–°èŠ‚ç‚¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
        tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>
        <span class="token class-name">K</span> k<span class="token punctuation">;</span>

        <span class="token comment">// 3. åˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸è¦æ’å…¥çš„ key ç›¸åŒ</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> p<span class="token punctuation">;</span>

        <span class="token comment">// 4. å¦‚æœæ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å…¥æ–¹æ³•</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
            e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 5. å¦åˆ™æ˜¯é“¾è¡¨ï¼Œéå†é“¾è¡¨</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// åˆ°è¾¾é“¾è¡¨å°¾éƒ¨ï¼Œæ’å…¥æ–°èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// é“¾è¡¨é•¿åº¦è¾¾åˆ° 8ï¼Œè½¬ä¸ºçº¢é»‘æ ‘</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">>=</span> <span class="token constant">TREEIFY_THRESHOLD</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token comment">// æ‰¾åˆ°ç›¸åŒçš„ key</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span><span class="token punctuation">;</span>

                p <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 6. å¦‚æœæ‰¾åˆ°ç›¸åŒçš„ keyï¼Œè¦†ç›–æ—§å€¼</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">V</span> oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
            <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
    <span class="token comment">// 7. åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">></span> threshold<span class="token punctuation">)</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="å…­-get-æ–¹æ³•æºç åˆ†æ">å…­ã€get æ–¹æ³•æºç åˆ†æ</h2>
<h3 id="6-1-get-æ–¹æ³•å…¥å£">6.1 get æ–¹æ³•å…¥å£</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">null</span> <span class="token operator">:</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="6-2-getNode-æ–¹æ³•è¯¦è§£">6.2 getNode æ–¹æ³•è¯¦è§£</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> <span class="token class-name">Object</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> first<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
    <span class="token keyword">int</span> n<span class="token punctuation">;</span>
    <span class="token class-name">K</span> k<span class="token punctuation">;</span>

    <span class="token comment">// 1. æ£€æŸ¥ table æ˜¯å¦ä¸ºç©º</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span>
        <span class="token punctuation">(</span>first <span class="token operator">=</span> tab<span class="token punctuation">[</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 2. æ£€æŸ¥ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦åŒ¹é…</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> first<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> first<span class="token punctuation">;</span>

        <span class="token comment">// 3. æ£€æŸ¥åç»­èŠ‚ç‚¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æŸ¥æ‰¾</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>first<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// åœ¨é“¾è¡¨ä¸­æŸ¥æ‰¾</span>
            <span class="token keyword">do</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> e<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="ä¸ƒ-æ‰©å®¹æœºåˆ¶-resize">ä¸ƒã€æ‰©å®¹æœºåˆ¶ï¼ˆresizeï¼‰</h2>
<h3 id="7-1-resize-æ–¹æ³•è¯¦è§£">7.1 resize æ–¹æ³•è¯¦è§£</h3>
<pre class="language-java"><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
    <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 1. è®¡ç®—æ–°å®¹é‡å’Œæ–°é˜ˆå€¼</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">>=</span> <span class="token constant">MAXIMUM_CAPACITY</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            threshold <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span>
                 oldCap <span class="token operator">>=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span>
            newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
        newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        newCap <span class="token operator">=</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_LOAD_FACTOR</span> <span class="token operator">*</span> <span class="token constant">DEFAULT_INITIAL_CAPACITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span>newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>
        newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token constant">MAXIMUM_CAPACITY</span> <span class="token operator">?</span>
                  <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>ft <span class="token operator">:</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token constant">MAX_VALUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>

    <span class="token comment">// 2. åˆ›å»ºæ–°æ•°ç»„</span>
    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"rawtypes"</span><span class="token punctuation">,</span><span class="token string">"unchecked"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>
    table <span class="token operator">=</span> newTab<span class="token punctuation">;</span>

    <span class="token comment">// 3. è¿ç§»æ—§æ•°ç»„ä¸­çš„å…ƒç´ </span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                    newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">)</span>e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment">// é“¾è¡¨ä¼˜åŒ–ï¼šå°†é“¾è¡¨åˆ†ä¸ºåŸç´¢å¼•å’ŒåŸç´¢å¼•+oldCapä¸¤ä¸ªä½ç½®</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> loHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> loTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> hiHead <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> hiTail <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next<span class="token punctuation">;</span>
                    <span class="token keyword">do</span> <span class="token punctuation">{</span>
                        next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">else</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                                hiHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            hiTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> newTab<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="7-2-æ‰©å®¹ä¼˜åŒ–">7.2 æ‰©å®¹ä¼˜åŒ–</h3>
<p>JDK 1.8 å¯¹æ‰©å®¹è¿›è¡Œäº†ä¼˜åŒ–ï¼š</p>
<ul>
<li>ä½¿ç”¨ <code>(e.hash &amp; oldCap)</code> åˆ¤æ–­å…ƒç´ æ˜¯åœ¨åŸä½ç½®è¿˜æ˜¯ç§»åŠ¨åˆ° <code>åŸä½ç½® + oldCap</code></li>
<li>è¿™æ ·å¯ä»¥é¿å…é‡æ–°è®¡ç®— hashï¼Œæé«˜æ•ˆç‡</li>
<li>ä¾‹å¦‚ï¼šåŸå®¹é‡ 16ï¼ˆ10000ï¼‰ï¼Œæ‰©å®¹å 32ï¼ˆ100000ï¼‰
<ul>
<li>å¦‚æœ <code>(e.hash &amp; 16) == 0</code>ï¼Œç´¢å¼•ä¸å˜</li>
<li>å¦‚æœ <code>(e.hash &amp; 16) != 0</code>ï¼Œç´¢å¼• = åŸç´¢å¼• + 16</li>
</ul>
</li>
</ul>
<h2 id="å…«-çº¢é»‘æ ‘è½¬æ¢">å…«ã€çº¢é»‘æ ‘è½¬æ¢</h2>
<h3 id="8-1-treeifyBin-æ–¹æ³•">8.1 treeifyBin æ–¹æ³•</h3>
<p>å½“é“¾è¡¨é•¿åº¦è¾¾åˆ° 8 æ—¶ï¼Œå°è¯•å°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">treeifyBin</span><span class="token punctuation">(</span><span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">int</span> hash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> n<span class="token punctuation">,</span> index<span class="token punctuation">;</span>
    <span class="token class-name">Node</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e<span class="token punctuation">;</span>

    <span class="token comment">// å¦‚æœæ•°ç»„é•¿åº¦å°äº 64ï¼Œå…ˆæ‰©å®¹è€Œä¸æ˜¯è½¬æ ‘</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>tab <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token constant">MIN_TREEIFY_CAPACITY</span><span class="token punctuation">)</span>
        <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> tab<span class="token punctuation">[</span>index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> hd <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">,</span> tl <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">do</span> <span class="token punctuation">{</span>
            <span class="token class-name">TreeNode</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> p <span class="token operator">=</span> <span class="token function">replacementTreeNode</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>tl <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                hd <span class="token operator">=</span> p<span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                p<span class="token punctuation">.</span>prev <span class="token operator">=</span> tl<span class="token punctuation">;</span>
                tl<span class="token punctuation">.</span>next <span class="token operator">=</span> p<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            tl <span class="token operator">=</span> p<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> hd<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            hd<span class="token punctuation">.</span><span class="token function">treeify</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="8-2-ä¸ºä»€ä¹ˆæ˜¯-8-å’Œ-6">8.2 ä¸ºä»€ä¹ˆæ˜¯ 8 å’Œ 6ï¼Ÿ</h3>
<ul>
<li><strong>8 è½¬ 16</strong>ï¼šé“¾è¡¨è½¬çº¢é»‘æ ‘</li>
<li><strong>6 è½¬ 16</strong>ï¼šçº¢é»‘æ ‘è½¬é“¾è¡¨</li>
</ul>
<p>è¿™æ ·è®¾è®¡æ˜¯ä¸ºäº†é¿å…é¢‘ç¹è½¬æ¢ï¼š</p>
<ul>
<li>æ ¹æ®æ³Šæ¾åˆ†å¸ƒï¼Œé“¾è¡¨é•¿åº¦è¾¾åˆ° 8 çš„æ¦‚ç‡éå¸¸å°ï¼ˆ0.00000006ï¼‰</li>
<li>å½“é•¿åº¦åœ¨ 6-8 ä¹‹é—´æ³¢åŠ¨æ—¶ï¼Œä¸ä¼šé¢‘ç¹è½¬æ¢</li>
<li>è¿™æ˜¯ä¸€ç§ç©ºé—´å’Œæ—¶é—´çš„æƒè¡¡</li>
</ul>
<h2 id="ä¹-çº¿ç¨‹å®‰å…¨é—®é¢˜">ä¹ã€çº¿ç¨‹å®‰å…¨é—®é¢˜</h2>
<p>HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå‡ºç°ä»¥ä¸‹é—®é¢˜ï¼š</p>
<h3 id="9-1-å¹¶å‘æ‰©å®¹é—®é¢˜">9.1 å¹¶å‘æ‰©å®¹é—®é¢˜</h3>
<p>JDK 1.7 ä¸­ä½¿ç”¨å¤´æ’æ³•ï¼Œå¹¶å‘æ‰©å®¹å¯èƒ½å¯¼è‡´é“¾è¡¨å½¢æˆç¯ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">void</span> <span class="token function">transfer</span><span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTable<span class="token punctuation">,</span> <span class="token keyword">boolean</span> rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> newTable<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> e <span class="token operator">:</span> table<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">K</span><span class="token punctuation">,</span><span class="token class-name">V</span><span class="token punctuation">></span></span> next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>rehash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span>hash <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token operator">==</span> e<span class="token punctuation">.</span>key <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token function">hash</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">indexFor</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span>next <span class="token operator">=</span> newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            newTable<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
            e <span class="token operator">=</span> next<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="9-2-JDK-1-8-çš„æ”¹è¿›">9.2 JDK 1.8 çš„æ”¹è¿›</h3>
<ul>
<li>æ”¹ç”¨å°¾æ’æ³•ï¼Œé¿å…äº†é“¾è¡¨ç¯çš„é—®é¢˜</li>
<li>ä½†ä»ç„¶å­˜åœ¨æ•°æ®ä¸¢å¤±å’Œè¦†ç›–çš„é—®é¢˜</li>
</ul>
<h3 id="9-3-è§£å†³æ–¹æ¡ˆ">9.3 è§£å†³æ–¹æ¡ˆ</h3>
<p>å¦‚æœéœ€è¦åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ï¼š</p>
<ul>
<li><strong>ConcurrentHashMap</strong>ï¼šçº¿ç¨‹å®‰å…¨çš„ HashMap</li>
<li><strong>Collections.synchronizedMap(new HashMap&lt;&gt;())</strong>ï¼šä½¿ç”¨åŒæ­¥åŒ…è£…å™¨</li>
<li><strong>Hashtable</strong>ï¼šçº¿ç¨‹å®‰å…¨çš„é—ç•™ç±»ï¼ˆä¸æ¨èï¼‰</li>
</ul>
<h2 id="å-å¸¸è§é¢è¯•é¢˜">åã€å¸¸è§é¢è¯•é¢˜</h2>
<h3 id="1-HashMap-çš„åº•å±‚æ•°æ®ç»“æ„">1. HashMap çš„åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h3>
<p>JDK 1.7ï¼šæ•°ç»„ + é“¾è¡¨<br>
JDK 1.8ï¼šæ•°ç»„ + é“¾è¡¨ + çº¢é»‘æ ‘</p>
<h3 id="2-ä¸ºä»€ä¹ˆ-JDK-1-8-è¦å¼•å…¥çº¢é»‘æ ‘">2. ä¸ºä»€ä¹ˆ JDK 1.8 è¦å¼•å…¥çº¢é»‘æ ‘ï¼Ÿ</h3>
<p>ä¸ºäº†è§£å†³é“¾è¡¨è¿‡é•¿å¯¼è‡´çš„æŸ¥è¯¢æ•ˆç‡é—®é¢˜ã€‚å½“é“¾è¡¨é•¿åº¦è¶…è¿‡ 8 æ—¶ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä» O(n) é™ä½åˆ° O(log n)ã€‚</p>
<h3 id="3-HashMap-çš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆ">3. HashMap çš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</h3>
<ul>
<li>å½“ size &gt; thresholdï¼ˆcapacity * loadFactorï¼‰æ—¶è§¦å‘æ‰©å®¹</li>
<li>æ‰©å®¹åå®¹é‡å˜ä¸ºåŸæ¥çš„ 2 å€</li>
<li>æ‰©å®¹æ—¶éœ€è¦é‡æ–°è®¡ç®—æ‰€æœ‰å…ƒç´ çš„ä½ç½®ï¼ˆJDK 1.8 æœ‰ä¼˜åŒ–ï¼‰</li>
</ul>
<h3 id="4-ä¸ºä»€ä¹ˆ-HashMap-çš„å®¹é‡å¿…é¡»æ˜¯-2-çš„-n-æ¬¡å¹‚">4. ä¸ºä»€ä¹ˆ HashMap çš„å®¹é‡å¿…é¡»æ˜¯ 2 çš„ n æ¬¡å¹‚ï¼Ÿ</h3>
<ul>
<li>æ–¹ä¾¿ä½¿ç”¨ä½è¿ç®—ä»£æ›¿å–æ¨¡è¿ç®—ï¼Œæé«˜æ•ˆç‡</li>
<li>ä½¿ hash åˆ†å¸ƒæ›´å‡åŒ€</li>
<li>ä¾¿äºæ‰©å®¹æ—¶çš„å…ƒç´ è¿ç§»</li>
</ul>
<h3 id="5-HashMap-çš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯-0-75">5. HashMap çš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯ 0.75ï¼Ÿ</h3>
<p>è¿™æ˜¯æ—¶é—´å’Œç©ºé—´çš„æƒè¡¡ï¼š</p>
<ul>
<li>å¤ªå°ï¼šç©ºé—´åˆ©ç”¨ç‡ä½ï¼Œé¢‘ç¹æ‰©å®¹</li>
<li>å¤ªå¤§ï¼šå“ˆå¸Œå†²çªå¢å¤šï¼ŒæŸ¥è¯¢æ•ˆç‡é™ä½</li>
<li>0.75 æ˜¯ç»è¿‡æ•°å­¦è®¡ç®—çš„æœ€ä¼˜å€¼</li>
</ul>
<h3 id="6-HashMap-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—">6. HashMap æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</h3>
<p>ä¸æ˜¯ï¼ŒHashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå­˜åœ¨ï¼š</p>
<ul>
<li>æ•°æ®ä¸¢å¤±</li>
<li>æ•°æ®è¦†ç›–</li>
<li>JDK 1.7 å¯èƒ½å‡ºç°æ­»å¾ªç¯</li>
</ul>
<h3 id="7-HashMap-ä¸­-key-ä¸º-null-æ—¶æ€ä¹ˆå¤„ç†">7. HashMap ä¸­ key ä¸º null æ—¶æ€ä¹ˆå¤„ç†ï¼Ÿ</h3>
<p>HashMap å…è®¸ä¸€ä¸ª null é”®ï¼Œnull é”®çš„ hash å€¼ä¸º 0ï¼Œå­˜æ”¾åœ¨æ•°ç»„çš„ç¬¬ 0 ä¸ªä½ç½®ã€‚</p>
<h3 id="8-HashMap-å’Œ-ConcurrentHashMap-çš„åŒºåˆ«">8. HashMap å’Œ ConcurrentHashMap çš„åŒºåˆ«ï¼Ÿ</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>HashMap</th>
<th>ConcurrentHashMap</th>
</tr>
</thead>
<tbody>
<tr>
<td>çº¿ç¨‹å®‰å…¨</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>å®ç°æ–¹å¼</td>
<td>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</td>
<td>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ + CAS + synchronized</td>
</tr>
<tr>
<td>null é”®å€¼</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
</tr>
<tr>
<td>è¿­ä»£å™¨</td>
<td>fail-fast</td>
<td>weakly consistent</td>
</tr>
</tbody>
</table>
<h3 id="9-HashMap-å’Œ-Hashtable-çš„åŒºåˆ«">9. HashMap å’Œ Hashtable çš„åŒºåˆ«ï¼Ÿ</h3>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>HashMap</th>
<th>Hashtable</th>
</tr>
</thead>
<tbody>
<tr>
<td>çº¿ç¨‹å®‰å…¨</td>
<td>å¦</td>
<td>æ˜¯</td>
</tr>
<tr>
<td>null é”®å€¼</td>
<td>å…è®¸</td>
<td>ä¸å…è®¸</td>
</tr>
<tr>
<td>ç»§æ‰¿</td>
<td>AbstractMap</td>
<td>Dictionary</td>
</tr>
<tr>
<td>æ•ˆç‡</td>
<td>é«˜</td>
<td>ä½</td>
</tr>
</tbody>
</table>
<h3 id="10-å¦‚ä½•ä¼˜åŒ–-HashMap-çš„æ€§èƒ½">10. å¦‚ä½•ä¼˜åŒ– HashMap çš„æ€§èƒ½ï¼Ÿ</h3>
<ul>
<li>è®¾ç½®åˆé€‚çš„åˆå§‹å®¹é‡ï¼Œé¿å…é¢‘ç¹æ‰©å®¹</li>
<li>é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­</li>
<li>ä½¿ç”¨ä¸å¯å˜å¯¹è±¡ä½œä¸º key</li>
<li>é‡å†™ hashCode å’Œ equals æ–¹æ³•</li>
</ul>
<h2 id="åä¸€-ä½¿ç”¨å»ºè®®">åä¸€ã€ä½¿ç”¨å»ºè®®</h2>
<h3 id="11-1-åˆå§‹åŒ–å®¹é‡">11.1 åˆå§‹åŒ–å®¹é‡</h3>
<p>å¦‚æœçŸ¥é“å¤§æ¦‚çš„å…ƒç´ æ•°é‡ï¼Œå¯ä»¥è®¾ç½®åˆå§‹å®¹é‡ï¼š</p>
<pre class="language-java"><code class="language-java"><span class="token keyword">int</span> expectedSize <span class="token operator">=</span> <span class="token number">10000</span><span class="token punctuation">;</span>
<span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">></span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span>expectedSize <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="11-2-é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­">11.2 é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­</h3>
<p>é»˜è®¤ 0.75 é€‚ç”¨äºå¤§å¤šæ•°åœºæ™¯ï¼Œå¦‚æœï¼š</p>
<ul>
<li>å†…å­˜ç´§å¼ ï¼šå¯ä»¥å¢å¤§è´Ÿè½½å› å­ï¼ˆå¦‚ 0.85ï¼‰</li>
<li>æŸ¥è¯¢æ€§èƒ½è¦æ±‚é«˜ï¼šå¯ä»¥å‡å°è´Ÿè½½å› å­ï¼ˆå¦‚ 0.5ï¼‰</li>
</ul>
<h3 id="11-3-é¿å…å¤§å¯¹è±¡ä½œä¸º-key">11.3 é¿å…å¤§å¯¹è±¡ä½œä¸º key</h3>
<p>å¤§å¯¹è±¡çš„ hashCode è®¡ç®—æˆæœ¬é«˜ï¼Œå»ºè®®ä½¿ç”¨ï¼š</p>
<ul>
<li>åŸºæœ¬ç±»å‹åŒ…è£…ç±»</li>
<li>String</li>
<li>è‡ªå®šä¹‰çš„ä¸å¯å˜å¯¹è±¡</li>
</ul>
<h2 id="åäºŒ-æ€»ç»“">åäºŒã€æ€»ç»“</h2>
<p>HashMap æ˜¯ Java é›†åˆæ¡†æ¶ä¸­æœ€é‡è¦çš„ç±»ä¹‹ä¸€ï¼Œå…¶è®¾è®¡ä½“ç°äº†ä»¥ä¸‹æ€æƒ³ï¼š</p>
<ol>
<li><strong>å“ˆå¸Œè¡¨çš„ç²¾å¦™è®¾è®¡</strong>ï¼šé€šè¿‡ hash ç®—æ³•å’Œä½è¿ç®—å®ç°å¿«é€ŸæŸ¥æ‰¾</li>
<li><strong>åŠ¨æ€æ‰©å®¹æœºåˆ¶</strong>ï¼šå¹³è¡¡äº†æ—¶é—´å’Œç©ºé—´çš„æ•ˆç‡</li>
<li><strong>çº¢é»‘æ ‘ä¼˜åŒ–</strong>ï¼šè§£å†³äº†é“¾è¡¨è¿‡é•¿çš„é—®é¢˜</li>
<li><strong>ä½è¿ç®—ä¼˜åŒ–</strong>ï¼šä½¿ç”¨ä½è¿ç®—ä»£æ›¿å–æ¨¡ï¼Œæé«˜æ•ˆç‡</li>
</ol>
<p>ç†è§£ HashMap çš„æºç ä¸ä»…æœ‰åŠ©äºé¢è¯•ï¼Œæ›´èƒ½å¸®åŠ©æˆ‘ä»¬å†™å‡ºæ›´é«˜æ•ˆçš„ä»£ç ã€‚</p>

          </div>

          <section class="share-section">
            <h3 class="share-title">åˆ†äº«è¿™ç¯‡æ–‡ç« </h3>
            <div class="share-buttons">
              <button class="share-button share-twitter" data-platform="twitter" aria-label="åˆ†äº«åˆ° Twitter">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
                <span>Twitter</span>
              </button>
              <button class="share-button share-weibo" data-platform="weibo" aria-label="åˆ†äº«åˆ°å¾®åš">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M10.5 2C6.357 2 3 5.357 3 9.5c0 2.45 1.197 4.627 3.046 5.964-.042.533-.053 1.1.05 1.732.378 2.327 2.48 4.304 5.204 4.304 3.037 0 5.5-2.463 5.5-5.5 0-2.043-1.118-3.827-2.78-4.777.19-.615.3-1.268.3-1.948 0-3.643-2.857-6.5-6.5-6.5zm0 1.5c2.485 0 4.5 2.015 4.5 4.5 0 .405-.065.795-.18 1.167-.55-.125-1.125-.192-1.715-.192-3.59 0-6.5 2.91-6.5 6.5 0 .59.067 1.165.192 1.715-1.247-1.057-2.042-2.635-2.042-4.392 0-3.037 2.463-5.5 5.5-5.5 2.485 0 4.5 2.015 4.5 4.5 0 2.485-2.015 4.5-4.5 4.5-2.485 0-4.5-2.015-4.5-4.5 0-2.485 2.015-4.5 4.5-4.5zm5.5 7c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z"></path></svg>
                <span>å¾®åš</span>
              </button>
              <button class="share-button share-link" data-platform="link" aria-label="å¤åˆ¶é“¾æ¥">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                <span>å¤åˆ¶é“¾æ¥</span>
              </button>
            </div>
            <div class="share-toast" id="shareToast">é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿</div>
          </section>

          
          <section class="comments-section">
            <div class="comments-container">
              <h3 class="comments-title">è¯„è®ºåŒº</h3>
              <div class="giscus-wrapper">
                <script src="https://giscus.app/client.js"
                  data-repo="zhizhi2213/zhizhi2213.github.io"
                  data-repo-id="R_kgDOH-1Z7w"
                  data-category="Announcements"
                  data-category-id="DIC_kwDOH-1Z784CfY7Q"
                  data-mapping="pathname"
                  data-strict="0"
                  data-reactions-enabled="1"
                  data-emit-metadata="0"
                  data-input-position="bottom"
                  data-theme="preferred_color_scheme"
                  data-lang="zh-CN"
                  data-loading="lazy"
                  crossorigin="anonymous"
                  async>
                </script>
              </div>
            </div>
          </section>
          

          <aside class="related-posts">
            <h3 class="related-posts-title">ç›¸å…³æ–‡ç« </h3>
            <ul class="related-posts-list">
              
              <li class="related-posts-item">
                <a href="/static/posts/MyBatisæºç æ·±åº¦è§£æ/" class="related-posts-link">
                  <h4 class="related-posts-item-title">MyBatisæºç æ·±åº¦è§£æ</h4>
                  <time class="related-posts-item-date">2026å¹´2æœˆ11æ—¥</time>
                </a>
              </li>
              
              <li class="related-posts-item">
                <a href="/static/posts/ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ/" class="related-posts-link">
                  <h4 class="related-posts-item-title">ThreadLocalå¼‚æ­¥åœºæ™¯é—®é¢˜è§£æ</h4>
                  <time class="related-posts-item-date">2026å¹´2æœˆ11æ—¥</time>
                </a>
              </li>
              
              <li class="related-posts-item">
                <a href="/static/posts/Spring-IOCä¸AOPè¯¦è§£/" class="related-posts-link">
                  <h4 class="related-posts-item-title">Spring IOCä¸AOPè¯¦è§£</h4>
                  <time class="related-posts-item-date">2026å¹´2æœˆ10æ—¥</time>
                </a>
              </li>
              
            </ul>
          </aside>
        </article>

        
        <aside class="toc-container">
          <nav class="toc-content" id="tocContent">
            <a href="#ä¸€-HashMap-ç®€ä»‹" class="toc-item toc-level-2" style="">ä¸€ã€HashMap ç®€ä»‹</a><a href="#ä¸»è¦ç‰¹ç‚¹" class="toc-item toc-level-3" style="padding-left: 1.5rem;">ä¸»è¦ç‰¹ç‚¹</a><a href="#äºŒ-æ ¸å¿ƒæ•°æ®ç»“æ„" class="toc-item toc-level-2" style="">äºŒã€æ ¸å¿ƒæ•°æ®ç»“æ„</a><a href="#2-1-Node-èŠ‚ç‚¹" class="toc-item toc-level-3" style="padding-left: 1.5rem;">2.1 Node èŠ‚ç‚¹</a><a href="#2-2-åº•å±‚ç»“æ„" class="toc-item toc-level-3" style="padding-left: 1.5rem;">2.2 åº•å±‚ç»“æ„</a><a href="#ä¸‰-å…³é”®å‚æ•°" class="toc-item toc-level-2" style="">ä¸‰ã€å…³é”®å‚æ•°</a><a href="#3-1-åˆå§‹å‚æ•°" class="toc-item toc-level-3" style="padding-left: 1.5rem;">3.1 åˆå§‹å‚æ•°</a><a href="#3-2-æ„é€ æ–¹æ³•" class="toc-item toc-level-3" style="padding-left: 1.5rem;">3.2 æ„é€ æ–¹æ³•</a><a href="#3-3-tableSizeFor-æ–¹æ³•" class="toc-item toc-level-3" style="padding-left: 1.5rem;">3.3 tableSizeFor æ–¹æ³•</a><a href="#å››-Hash-ç®—æ³•" class="toc-item toc-level-2" style="">å››ã€Hash ç®—æ³•</a><a href="#4-1-hash-æ–¹æ³•" class="toc-item toc-level-3" style="padding-left: 1.5rem;">4.1 hash æ–¹æ³•</a><a href="#4-2-ç´¢å¼•è®¡ç®—" class="toc-item toc-level-3" style="padding-left: 1.5rem;">4.2 ç´¢å¼•è®¡ç®—</a><a href="#äº”-put-æ–¹æ³•æºç åˆ†æ" class="toc-item toc-level-2" style="">äº”ã€put æ–¹æ³•æºç åˆ†æ</a><a href="#5-1-put-æ–¹æ³•å…¥å£" class="toc-item toc-level-3" style="padding-left: 1.5rem;">5.1 put æ–¹æ³•å…¥å£</a><a href="#5-2-putVal-æ–¹æ³•è¯¦è§£" class="toc-item toc-level-3" style="padding-left: 1.5rem;">5.2 putVal æ–¹æ³•è¯¦è§£</a><a href="#å…­-get-æ–¹æ³•æºç åˆ†æ" class="toc-item toc-level-2" style="">å…­ã€get æ–¹æ³•æºç åˆ†æ</a><a href="#6-1-get-æ–¹æ³•å…¥å£" class="toc-item toc-level-3" style="padding-left: 1.5rem;">6.1 get æ–¹æ³•å…¥å£</a><a href="#6-2-getNode-æ–¹æ³•è¯¦è§£" class="toc-item toc-level-3" style="padding-left: 1.5rem;">6.2 getNode æ–¹æ³•è¯¦è§£</a><a href="#ä¸ƒ-æ‰©å®¹æœºåˆ¶-resize" class="toc-item toc-level-2" style="">ä¸ƒã€æ‰©å®¹æœºåˆ¶ï¼ˆresizeï¼‰</a><a href="#7-1-resize-æ–¹æ³•è¯¦è§£" class="toc-item toc-level-3" style="padding-left: 1.5rem;">7.1 resize æ–¹æ³•è¯¦è§£</a><a href="#7-2-æ‰©å®¹ä¼˜åŒ–" class="toc-item toc-level-3" style="padding-left: 1.5rem;">7.2 æ‰©å®¹ä¼˜åŒ–</a><a href="#å…«-çº¢é»‘æ ‘è½¬æ¢" class="toc-item toc-level-2" style="">å…«ã€çº¢é»‘æ ‘è½¬æ¢</a><a href="#8-1-treeifyBin-æ–¹æ³•" class="toc-item toc-level-3" style="padding-left: 1.5rem;">8.1 treeifyBin æ–¹æ³•</a><a href="#8-2-ä¸ºä»€ä¹ˆæ˜¯-8-å’Œ-6" class="toc-item toc-level-3" style="padding-left: 1.5rem;">8.2 ä¸ºä»€ä¹ˆæ˜¯ 8 å’Œ 6ï¼Ÿ</a><a href="#ä¹-çº¿ç¨‹å®‰å…¨é—®é¢˜" class="toc-item toc-level-2" style="">ä¹ã€çº¿ç¨‹å®‰å…¨é—®é¢˜</a><a href="#9-1-å¹¶å‘æ‰©å®¹é—®é¢˜" class="toc-item toc-level-3" style="padding-left: 1.5rem;">9.1 å¹¶å‘æ‰©å®¹é—®é¢˜</a><a href="#9-2-JDK-1-8-çš„æ”¹è¿›" class="toc-item toc-level-3" style="padding-left: 1.5rem;">9.2 JDK 1.8 çš„æ”¹è¿›</a><a href="#9-3-è§£å†³æ–¹æ¡ˆ" class="toc-item toc-level-3" style="padding-left: 1.5rem;">9.3 è§£å†³æ–¹æ¡ˆ</a><a href="#å-å¸¸è§é¢è¯•é¢˜" class="toc-item toc-level-2" style="">åã€å¸¸è§é¢è¯•é¢˜</a><a href="#1-HashMap-çš„åº•å±‚æ•°æ®ç»“æ„" class="toc-item toc-level-3" style="padding-left: 1.5rem;">1. HashMap çš„åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</a><a href="#2-ä¸ºä»€ä¹ˆ-JDK-1-8-è¦å¼•å…¥çº¢é»‘æ ‘" class="toc-item toc-level-3" style="padding-left: 1.5rem;">2. ä¸ºä»€ä¹ˆ JDK 1.8 è¦å¼•å…¥çº¢é»‘æ ‘ï¼Ÿ</a><a href="#3-HashMap-çš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆ" class="toc-item toc-level-3" style="padding-left: 1.5rem;">3. HashMap çš„æ‰©å®¹æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ</a><a href="#4-ä¸ºä»€ä¹ˆ-HashMap-çš„å®¹é‡å¿…é¡»æ˜¯-2-çš„-n-æ¬¡å¹‚" class="toc-item toc-level-3" style="padding-left: 1.5rem;">4. ä¸ºä»€ä¹ˆ HashMap çš„å®¹é‡å¿…é¡»æ˜¯ 2 çš„ n æ¬¡å¹‚ï¼Ÿ</a><a href="#5-HashMap-çš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯-0-75" class="toc-item toc-level-3" style="padding-left: 1.5rem;">5. HashMap çš„è´Ÿè½½å› å­ä¸ºä»€ä¹ˆæ˜¯ 0.75ï¼Ÿ</a><a href="#6-HashMap-æ˜¯çº¿ç¨‹å®‰å…¨çš„å—" class="toc-item toc-level-3" style="padding-left: 1.5rem;">6. HashMap æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</a><a href="#7-HashMap-ä¸­-key-ä¸º-null-æ—¶æ€ä¹ˆå¤„ç†" class="toc-item toc-level-3" style="padding-left: 1.5rem;">7. HashMap ä¸­ key ä¸º null æ—¶æ€ä¹ˆå¤„ç†ï¼Ÿ</a><a href="#8-HashMap-å’Œ-ConcurrentHashMap-çš„åŒºåˆ«" class="toc-item toc-level-3" style="padding-left: 1.5rem;">8. HashMap å’Œ ConcurrentHashMap çš„åŒºåˆ«ï¼Ÿ</a><a href="#9-HashMap-å’Œ-Hashtable-çš„åŒºåˆ«" class="toc-item toc-level-3" style="padding-left: 1.5rem;">9. HashMap å’Œ Hashtable çš„åŒºåˆ«ï¼Ÿ</a><a href="#10-å¦‚ä½•ä¼˜åŒ–-HashMap-çš„æ€§èƒ½" class="toc-item toc-level-3" style="padding-left: 1.5rem;">10. å¦‚ä½•ä¼˜åŒ– HashMap çš„æ€§èƒ½ï¼Ÿ</a><a href="#åä¸€-ä½¿ç”¨å»ºè®®" class="toc-item toc-level-2" style="">åä¸€ã€ä½¿ç”¨å»ºè®®</a><a href="#11-1-åˆå§‹åŒ–å®¹é‡" class="toc-item toc-level-3" style="padding-left: 1.5rem;">11.1 åˆå§‹åŒ–å®¹é‡</a><a href="#11-2-é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­" class="toc-item toc-level-3" style="padding-left: 1.5rem;">11.2 é€‰æ‹©åˆé€‚çš„è´Ÿè½½å› å­</a><a href="#11-3-é¿å…å¤§å¯¹è±¡ä½œä¸º-key" class="toc-item toc-level-3" style="padding-left: 1.5rem;">11.3 é¿å…å¤§å¯¹è±¡ä½œä¸º key</a><a href="#åäºŒ-æ€»ç»“" class="toc-item toc-level-2" style="">åäºŒã€æ€»ç»“</a>
          </nav>
        </aside>
        
      </div>
    </div>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2026 zhizhi2213. All rights reserved.</p>
      <p class="footer-links">
        <a href="/atom.xml" aria-label="RSS è®¢é˜…">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg>
          RSS è®¢é˜…
        </a>
      </p>
    </div>
  </footer>

  <button class="back-to-top" id="backToTop" aria-label="è¿”å›é¡¶éƒ¨">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
  </button>

  <button class="reading-mode-toggle" id="readingModeToggle" aria-label="é˜…è¯»æ¨¡å¼" title="åˆ‡æ¢é˜…è¯»æ¨¡å¼">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg>
  </button>

  <script src="/static/assets/script.js" defer></script>
</body>
</html>
